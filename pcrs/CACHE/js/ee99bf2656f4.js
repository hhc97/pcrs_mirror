var interval;$(function(){$('#button-id-go').click(function(){update();if(!$('#id_final').is(':checked')){interval=setInterval(update,2000);}});});function update(){$.post(document.URL+'_data',{time:$("#id_time").val(),section:$("#id_section").val()}).success(function(data){clearCanvases();if(data['submissions'].length>0){createSubmissionGraph([data['submissions']]);}
if(data['data'].length>0){createSubmissionDetailsGraph(data['data']);}});}
function clearCanvases(){var canvas=document.getElementById('submissions-graph');var ctx1=canvas.getContext("2d");ctx1.clearRect(0,0,canvas.width,canvas.height);canvas=document.getElementById('details-graph');var ctx2=canvas.getContext("2d");ctx2.clearRect(0,0,canvas.width,canvas.height);}
function createSubmissionGraph(data){var graph=new RGraph.Bar('submissions-graph',data);graph.Set('chart.labels',['Correct','Incorrect']);graph.Set('chart.labels.above',true);graph.Set('chart.background.grid',false);graph.Set('chart.colors',['#3C9A45','#E31837']);graph.Draw();}
function createSubmissionDetailsGraph(data){var canvas=$("#details-graph");canvas.attr("width",data.length*150);var graph=new RGraph.Bar('details-graph',data);graph.Set('chart.background.grid',false);graph.Set('chart.labels.above',true);graph.Set('chart.colors',['#3C9A45','#E31837']);graph.Draw();}
$(document).ajaxError(function(){alert('Something went wrong.');});var csrftoken=getCookie('csrftoken');var sessionid=getCookie('sessionid');jQuery.ajaxSettings.traditional=true;function getCookie(name){var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}
function csrfSafeMethod(method){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));}
$.ajaxSetup({crossDomain:false,beforeSend:function(xhr,settings){if(!csrfSafeMethod(settings.type)){xhr.setRequestHeader("X-CSRFToken",csrftoken);}}});if(typeof(RGraph)=='undefined')RGraph={isRGraph:true,type:'common'};RGraph.Registry={};RGraph.Registry.store=[];RGraph.Registry.store['chart.event.handlers']=[];RGraph.Registry.store['__rgraph_event_listeners__']=[];RGraph.background={};RGraph.objects=[];RGraph.Resizing={};RGraph.events=[];RGraph.cursor=[];RGraph.ObjectRegistry={};RGraph.ObjectRegistry.objects={};RGraph.ObjectRegistry.objects.byUID=[];RGraph.ObjectRegistry.objects.byCanvasID=[];HALFPI=(Math.PI/2);PI=Math.PI;TWOPI=PI*2;RGraph.getScale=function(max,obj)
{if(max==0){return['0.2','0.4','0.6','0.8','1.0'];}
var original_max=max;if(max<=1){if(max>0.5){return[0.2,0.4,0.6,0.8,Number(1).toFixed(1)];}else if(max>=0.1){return obj.Get('chart.scale.round')?[0.2,0.4,0.6,0.8,1]:[0.1,0.2,0.3,0.4,0.5];}else{var tmp=max;var exp=0;while(tmp<1.01){exp+=1;tmp*=10;}
var ret=['2e-'+exp,'4e-'+exp,'6e-'+exp,'8e-'+exp,'10e-'+exp];if(max<=('5e-'+exp)){ret=['1e-'+exp,'2e-'+exp,'3e-'+exp,'4e-'+exp,'5e-'+exp];}
return ret;}}
if(String(max).indexOf('.')>0){max=String(max).replace(/\.\d+$/,'');}
var interval=Math.pow(10,Number(String(Number(max)).length-1));var topValue=interval;while(topValue<max){topValue+=(interval/2);}
if(Number(original_max)>Number(topValue)){topValue+=(interval/2);}
if(max<10){topValue=(Number(original_max)<=5?5:10);}
if(obj&&typeof(obj.Get('chart.scale.round'))=='boolean'&&obj.Get('chart.scale.round')){topValue=10*interval;}
return[topValue*0.2,topValue*0.4,topValue*0.6,topValue*0.8,topValue];}
RGraph.array_max=function(arr)
{var max=null;if(typeof(arr)=='number'){return arr;}
for(var i=0;i<arr.length;++i){if(typeof(arr[i])=='number'){var val=arguments[1]?Math.abs(arr[i]):arr[i];if(typeof(max)=='number'){max=Math.max(max,val);}else{max=val;}}}
return max;}
RGraph.array_pad=function(arr,len)
{if(arr.length<len){var val=arguments[2]?arguments[2]:null;for(var i=arr.length;i<len;++i){arr[i]=val;}}
return arr;}
RGraph.array_sum=function(arr)
{if(typeof(arr)=='number'){return arr;}
var i,sum;var len=arr.length;for(i=0,sum=0;i<len;sum+=arr[i++]);return sum;}
RGraph.array_linearize=function()
{var arr=[];for(var i=0;i<arguments.length;++i){if(typeof(arguments[i])=='object'&&arguments[i]){for(var j=0;j<arguments[i].length;++j){var sub=RGraph.array_linearize(arguments[i][j]);for(var k=0;k<sub.length;++k){arr.push(sub[k]);}}}else{arr.push(arguments[i]);}}
return arr;}
RGraph.Text=function(context,font,size,x,y,text)
{if((typeof(text)!='string'&&typeof(text)!='number')||text=='undefined'){return;}
if(typeof(text)=='string'){if(text.indexOf('\r\n')>0&&arguments[6]=='center'){var line_count=text.split('\r\n').length;y=y-((line_count-1.5)*size);}else if(text.indexOf('\r\n')>0&&arguments[6]=='bottom'){var line_count=text.split('\r\n').length;y=y-((line_count-0.5)*size);}}
if(typeof(text)=='string'&&text.match(/\r\n/)){var arr=text.split('\r\n');text=arr[0];arr=RGraph.array_shift(arr);var nextline=arr.join('\r\n')
RGraph.Text(context,font,size,arguments[9]==-90?(x+(size*1.5)):x,y+(size*1.5),nextline,arguments[6]?arguments[6]:null,arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12]);}
if(RGraph.isOld()){y+=2;}
context.font=(arguments[11]?'Bold ':'')+size+'pt '+font;var i;var origX=x;var origY=y;var originalFillStyle=context.fillStyle;var originalLineWidth=context.lineWidth;if(typeof(arguments[6])==null)arguments[6]='bottom';if(typeof(arguments[7])==null)arguments[7]='left';if(typeof(arguments[8])==null)arguments[8]=null;if(typeof(arguments[9])==null)arguments[9]=0;if(typeof(arguments[12])==null)arguments[12]=true;if(navigator.userAgent.indexOf('Opera')!=-1){context.canvas.__rgraph_valign__=arguments[6];context.canvas.__rgraph_halign__=arguments[7];}
context.save();context.canvas.__rgraph_originalx__=x;context.canvas.__rgraph_originaly__=y;context.translate(x,y);x=0;y=0;if(arguments[9]){context.rotate(arguments[9]/57.3);}
if(arguments[6]){var vAlign=arguments[6];if(vAlign=='center'){context.translate(0,size/2);}else if(vAlign=='top'){context.translate(0,size);}}
if(arguments[7]){var hAlign=arguments[7];var width=context.measureText(text).width;if(hAlign){if(hAlign=='center'){context.translate(-1*(width/2),0)}else if(hAlign=='right'){context.translate(-1*width,0)}}}
context.fillStyle=originalFillStyle;context.save();context.fillText(text,0,0);context.lineWidth=1;if(arguments[8]){var width=context.measureText(text).width;var ieOffset=RGraph.isIE8()?2:0;context.translate(x,y);context.strokeRect(AA(context.canvas.__object__,-3),AA(context.canvas.__object__,0-3-size-ieOffset),width+6,0+size+6);if(arguments[10]){var offset=3;var ieOffset=RGraph.isIE8()?2:0;var width=context.measureText(text).width
context.fillStyle=arguments[10];context.fillRect(AA(context.canvas.__object__,x-offset),AA(context.canvas.__object__,y-size-offset-ieOffset),width+(2*offset),size+(2*offset));}
context.fillStyle=originalFillStyle;if(arguments[6]='center'){context.ttextBaseline='middle';}
context.fillText(text,0,0);if(arguments[12]){context.fillRect(arguments[7]=='left'?0:(arguments[7]=='center'?width/2:width)-2,arguments[6]=='bottom'?0:(arguments[6]=='center'?(0-size)/2:0-size)-2,4,4);}}
context.restore();context.lineWidth=originalLineWidth;context.restore();}
RGraph.Clear=function(canvas)
{if(!canvas){return;}
RGraph.FireCustomEvent(canvas.__object__,'onbeforeclear');var context=canvas.getContext('2d');var color=arguments[1];if(RGraph.isIE8()&&!color){color='white';}
if(!color||(color&&color=='transparent')){context.clearRect(0,0,canvas.width,canvas.height);context.globalCompositeOperation='source-over';}else{context.fillStyle=color;context=canvas.getContext('2d');context.beginPath();if(RGraph.isIE8()){context.fillRect(0,0,canvas.width,canvas.height);}else{context.fillRect(-10,-10,canvas.width+20,canvas.height+20);}
context.fill();}
if(RGraph.ClearAnnotations){}
if(RGraph.Registry.Get('chart.background.image.'+canvas.id)){var img=RGraph.Registry.Get('chart.background.image.'+canvas.id);img.style.position='absolute';img.style.left='-10000px';img.style.top='-10000px';}
if(RGraph.Registry.Get('chart.tooltip')){RGraph.HideTooltip();}
canvas.style.cursor='default';RGraph.FireCustomEvent(canvas.__object__,'onclear');}
RGraph.DrawTitle=function(obj,text,gutterTop)
{var canvas=obj.canvas;var context=obj.context;var gutterLeft=obj.Get('chart.gutter.left');var gutterRight=obj.Get('chart.gutter.right');var gutterBottom=obj.Get('chart.gutter.bottom');var size=arguments[4]?arguments[4]:12;var bold=obj.Get('chart.title.bold');var centerx=(arguments[3]?arguments[3]:((obj.canvas.width-gutterLeft-gutterRight)/2)+gutterLeft);var keypos=obj.Get('chart.key.position');var vpos=obj.Get('chart.title.vpos');var hpos=obj.Get('chart.title.hpos');var bgcolor=obj.Get('chart.title.background');if(obj.type=='bar'&&obj.Get('chart.variant')=='3d'){keypos='gutter';}
context.beginPath();context.fillStyle=obj.Get('chart.text.color')?obj.Get('chart.text.color'):'black';if(keypos&&keypos!='gutter'){var vCenter='center';}else if(!keypos){var vCenter='center';}else{var vCenter='bottom';}
if(typeof(obj.Get('chart.title.vpos'))=='number'){vpos=obj.Get('chart.title.vpos')*gutterTop;if(obj.Get('chart.xaxispos')=='top'){vpos=obj.Get('chart.title.vpos')*gutterBottom+gutterTop+(obj.canvas.height-gutterTop-gutterBottom);}}else{vpos=gutterTop-size-5;if(obj.Get('chart.xaxispos')=='top'){vpos=obj.canvas.height-gutterBottom+size+5;}}
if(typeof(hpos)=='number'){centerx=hpos*canvas.width;}
if(typeof(obj.Get('chart.title.color')!=null)){var oldColor=context.fillStyle
var newColor=obj.Get('chart.title.color')
context.fillStyle=newColor?newColor:'black';}
var font=obj.Get('chart.text.font');if(typeof(obj.Get('chart.title.font'))=='string'){font=obj.Get('chart.title.font');}
RGraph.Text(context,font,size,centerx,vpos,text,vCenter,'center',bgcolor!=null,null,bgcolor,bold);context.fillStyle=oldColor;}
RGraph.getMouseXY=function(e)
{var el=((RGraph.isIE8()||RGraph.isIE7())?event.srcElement:e.target);var x;var y;var paddingLeft=el.style.paddingLeft?parseInt(el.style.paddingLeft):0;var paddingTop=el.style.paddingTop?parseInt(el.style.paddingTop):0;var borderLeft=el.style.borderLeftWidth?parseInt(el.style.borderLeftWidth):0;var borderTop=el.style.borderTopWidth?parseInt(el.style.borderTopWidth):0;if(RGraph.isIE8())e=event;if(typeof(e.offsetX)=='number'&&typeof(e.offsetY)=='number'){x=e.offsetX;y=e.offsetY;}else{x=0;y=0;while(el!=document.body&&el){x+=el.offsetLeft;y+=el.offsetTop;el=el.offsetParent;}
x=e.pageX-x;y=e.pageY-y;}
return[x,y];}
RGraph.getCanvasXY=function(canvas)
{var x=0;var y=0;var obj=canvas;do{x+=obj.offsetLeft;y+=obj.offsetTop;obj=obj.offsetParent;}while(obj&&obj.tagName.toLowerCase()!='body');var paddingLeft=canvas.style.paddingLeft?parseInt(canvas.style.paddingLeft):0;var paddingTop=canvas.style.paddingTop?parseInt(canvas.style.paddingTop):0;var borderLeft=canvas.style.borderLeftWidth?parseInt(canvas.style.borderLeftWidth):0;var borderTop=canvas.style.borderTopWidth?parseInt(canvas.style.borderTopWidth):0;return[x+paddingLeft+borderLeft,y+paddingTop+borderTop];}
RGraph.Register=function(obj)
{if(!obj.Get('chart.noregister')){RGraph.ObjectRegistry.Add(obj);obj.Set('chart.noregister',true);}}
RGraph.Redraw=function()
{var objectRegistry=RGraph.ObjectRegistry.objects.byCanvasID;var tags=document.getElementsByTagName('canvas');for(var i=0;i<tags.length;++i){if(tags[i].__object__&&tags[i].__object__.isRGraph){RGraph.Clear(tags[i],arguments[0]?arguments[0]:null);}}
for(var i=0;i<objectRegistry.length;++i){if(objectRegistry[i]){var id=objectRegistry[i][0];objectRegistry[i][1].Draw();}}}
RGraph.RedrawCanvas=function(canvas)
{var objects=RGraph.ObjectRegistry.getObjectsByCanvasID(canvas.id);if(!arguments[1]||(typeof(arguments[1])=='boolean'&&!arguments[1]==false)){RGraph.Clear(canvas);}
for(var i=0;i<objects.length;++i){if(objects[i]){if(objects[i]&&objects[i].isRGraph){objects[i].Draw();}}}}
RGraph.background.Draw=function(obj)
{var canvas=obj.canvas;var context=obj.context;var height=0;var gutterLeft=obj.Get('chart.gutter.left');var gutterRight=obj.Get('chart.gutter.right');var gutterTop=obj.Get('chart.gutter.top');var gutterBottom=obj.Get('chart.gutter.bottom');var variant=obj.Get('chart.variant');context.fillStyle=obj.Get('chart.text.color');if(variant=='3d'){context.save();context.translate(10,-5);}
if(typeof(obj.Get('chart.title.xaxis'))=='string'&&obj.Get('chart.title.xaxis').length){var size=obj.Get('chart.text.size')+2;var font=obj.Get('chart.text.font');var bold=obj.Get('chart.title.xaxis.bold');if(typeof(obj.Get('chart.title.xaxis.size'))=='number'){size=obj.Get('chart.title.xaxis.size');}
if(typeof(obj.Get('chart.title.xaxis.font'))=='string'){font=obj.Get('chart.title.xaxis.font');}
var hpos=((obj.canvas.width-obj.gutterLeft-obj.gutterRight)/2)+obj.gutterLeft;var vpos=obj.canvas.height-obj.Get('chart.gutter.bottom')+25;if(typeof(obj.Get('chart.title.xaxis.pos'))=='number'){vpos=obj.canvas.height-(gutterBottom*obj.Get('chart.title.xaxis.pos'));}
context.beginPath();RGraph.Text(context,font,size,hpos,vpos,obj.Get('chart.title.xaxis'),'center','center',false,false,false,bold);context.fill();}
if(typeof(obj.Get('chart.title.yaxis'))=='string'&&obj.Get('chart.title.yaxis').length){var size=obj.Get('chart.text.size')+2;var font=obj.Get('chart.text.font');var angle=270;var bold=obj.Get('chart.title.yaxis.bold');if(typeof(obj.Get('chart.title.yaxis.pos'))=='number'){var yaxis_title_pos=obj.Get('chart.title.yaxis.pos')*obj.Get('chart.gutter.left');}else{var yaxis_title_pos=((obj.Get('chart.gutter.left')-25)/obj.Get('chart.gutter.left'))*obj.Get('chart.gutter.left');}
if(typeof(obj.Get('chart.title.yaxis.size'))=='number'){size=obj.Get('chart.title.yaxis.size');}
if(typeof(obj.Get('chart.title.yaxis.font'))=='string'){font=obj.Get('chart.title.yaxis.font');}
if(obj.Get('chart.title.yaxis.align')=='right'||obj.Get('chart.title.yaxis.position')=='right'){angle=90;yaxis_title_pos=obj.Get('chart.title.yaxis.pos')?obj.Get('chart.title.yaxis.pos')*obj.Get('chart.gutter.right'):obj.canvas.width-obj.Get('chart.gutter.right')+obj.Get('chart.text.size')+5;}else{yaxis_title_pos=yaxis_title_pos;}
context.beginPath();RGraph.Text(context,font,size,yaxis_title_pos,((obj.canvas.height-obj.gutterTop-obj.gutterBottom)/2)+obj.gutterTop,obj.Get('chart.title.yaxis'),'center','center',false,angle,false,bold);context.fill();}
obj.context.beginPath();context.fillStyle=obj.Get('chart.background.barcolor1');height=(RGraph.GetHeight(obj)-gutterBottom);for(var i=gutterTop;i<height;i+=80){obj.context.fillRect(gutterLeft,i,RGraph.GetWidth(obj)-gutterLeft-gutterRight,Math.min(40,RGraph.GetHeight(obj)-gutterBottom-i));}
context.fillStyle=obj.Get('chart.background.barcolor2');height=(RGraph.GetHeight(obj)-gutterBottom);for(var i=(40+gutterTop);i<height;i+=80){obj.context.fillRect(gutterLeft,i,RGraph.GetWidth(obj)-gutterLeft-gutterRight,i+40>(RGraph.GetHeight(obj)-gutterBottom)?RGraph.GetHeight(obj)-(gutterBottom+i):40);}
context.stroke();if(obj.Get('chart.background.grid')){if(obj.Get('chart.background.grid.autofit')){if(obj.Get('chart.background.grid.autofit.align')){obj.Set('chart.background.grid.autofit.numhlines',obj.Get('chart.ylabels.count'));if(obj.type=='line'){if(obj.Get('chart.labels')&&obj.Get('chart.labels').length){obj.Set('chart.background.grid.autofit.numvlines',obj.Get('chart.labels').length-1);}else{obj.Set('chart.background.grid.autofit.numvlines',obj.data[0].length-1);}}else if(obj.type=='bar'&&obj.Get('chart.labels')&&obj.Get('chart.labels').length){obj.Set('chart.background.grid.autofit.numvlines',obj.Get('chart.labels').length);}}
var vsize=((obj.canvas.width-gutterLeft-gutterRight))/obj.Get('chart.background.grid.autofit.numvlines');var hsize=(obj.canvas.height-gutterTop-gutterBottom)/obj.Get('chart.background.grid.autofit.numhlines');obj.Set('chart.background.grid.vsize',vsize);obj.Set('chart.background.grid.hsize',hsize);}
context.beginPath();context.lineWidth=obj.Get('chart.background.grid.width')?obj.Get('chart.background.grid.width'):1;context.strokeStyle=obj.Get('chart.background.grid.color');if(obj.Get('chart.background.grid.hlines')){height=(RGraph.GetHeight(obj)-gutterBottom)
for(y=gutterTop;y<height;y+=obj.Get('chart.background.grid.hsize')){context.moveTo(gutterLeft,AA(this,y));context.lineTo(RGraph.GetWidth(obj)-gutterRight,AA(this,y));}}
if(obj.Get('chart.background.grid.vlines')){var width=(obj.canvas.width-gutterRight)
for(x=gutterLeft;x<=width;x+=obj.Get('chart.background.grid.vsize')){context.moveTo(AA(this,x),gutterTop);context.lineTo(AA(this,x),obj.canvas.height-gutterBottom);}}
if(obj.Get('chart.background.grid.border')){context.strokeStyle=obj.Get('chart.background.grid.color');context.strokeRect(AA(this,gutterLeft),AA(this,gutterTop),RGraph.GetWidth(obj)-gutterLeft-gutterRight,RGraph.GetHeight(obj)-gutterTop-gutterBottom);}}
context.stroke();if(variant=='3d'){context.restore();}
if(typeof(obj.Get('chart.title'))=='string'){if(obj.type=='gantt'){gutterTop-=10;}
RGraph.DrawTitle(obj,obj.Get('chart.title'),gutterTop,null,obj.Get('chart.title.size')?obj.Get('chart.title.size'):obj.Get('chart.text.size')+2);}
context.stroke();}
RGraph.GetDays=function(obj)
{var year=obj.getFullYear();var days=obj.getDate();var month=obj.getMonth();if(month==0)return days;if(month>=1)days+=31;if(month>=2)days+=28;if(year>=2008&&year%4==0)days+=1;if(month>=3)days+=31;if(month>=4)days+=30;if(month>=5)days+=31;if(month>=6)days+=30;if(month>=7)days+=31;if(month>=8)days+=31;if(month>=9)days+=30;if(month>=10)days+=31;if(month>=11)days+=30;return days;}
RGraph.array_clone=function(obj)
{if(obj==null||typeof(obj)!='object'){return obj;}
var temp=[];for(var i=0;i<obj.length;++i){if(typeof(obj[i])=='number'){temp[i]=(function(arg){return Number(arg);})(obj[i]);}else if(typeof(obj[i])=='string'){temp[i]=(function(arg){return String(arg);})(obj[i]);}else if(typeof(obj[i])=='function'){temp[i]=obj[i];}else{temp[i]=RGraph.array_clone(obj[i]);}}
return temp;}
RGraph.number_format=function(obj,num)
{var i;var prepend=arguments[2]?String(arguments[2]):'';var append=arguments[3]?String(arguments[3]):'';var output='';var decimal='';var decimal_seperator=obj.Get('chart.scale.point')?obj.Get('chart.scale.point'):'.';var thousand_seperator=obj.Get('chart.scale.thousand')?obj.Get('chart.scale.thousand'):',';RegExp.$1='';var i,j;if(typeof(obj.Get('chart.scale.formatter'))=='function'){return obj.Get('chart.scale.formatter')(obj,num);}
if(String(num).indexOf('e')>0){return String(prepend+String(num)+append);}
num=String(num);if(num.indexOf('.')>0){var tmp=num;num=num.replace(/\.(.*)/,'');decimal=tmp.replace(/(.*)\.(.*)/,'$2');}
var seperator=thousand_seperator;var foundPoint;for(i=(num.length-1),j=0;i>=0;j++,i--){var character=num.charAt(i);if(j%3==0&&j!=0){output+=seperator;}
output+=character;}
var rev=output;output='';for(i=(rev.length-1);i>=0;i--){output+=rev.charAt(i);}
if(output.indexOf('-'+obj.Get('chart.scale.thousand'))==0){output='-'+output.substr(('-'+obj.Get('chart.scale.thousand')).length);}
if(decimal.length){output=output+decimal_seperator+decimal;decimal='';RegExp.$1='';}
if(output.charAt(0)=='-'){output=output.replace(/-/,'');prepend='-'+prepend;}
return prepend+output+append;}
RGraph.DrawBars=function(obj)
{var hbars=obj.Get('chart.background.hbars');obj.context.beginPath();for(i=0;i<hbars.length;++i){if(hbars[i][1]==null){hbars[i][1]=obj.max;}else if(hbars[i][0]+hbars[i][1]>obj.max){hbars[i][1]=obj.max-hbars[i][0];}
if(Math.abs(hbars[i][1])>obj.max){hbars[i][1]=-1*obj.max;}
if(Math.abs(hbars[i][0])>obj.max){hbars[i][0]=obj.max;}
if(hbars[i][0]+hbars[i][1]<(-1*obj.max)){hbars[i][1]=-1*(obj.max+hbars[i][0]);}
if(obj.Get('chart.xaxispos')=='bottom'&&(hbars[i][0]<0||(hbars[i][1]+hbars[i][1]<0))){alert('['+obj.type.toUpperCase()+' (ID: '+obj.id+') BACKGROUND HBARS] You have a negative value in one of your background hbars values, whilst the X axis is in the center');}
var ystart=(obj.grapharea-((hbars[i][0]/obj.max)*obj.grapharea));var height=(Math.min(hbars[i][1],obj.max-hbars[i][0])/obj.max)*obj.grapharea;if(obj.Get('chart.xaxispos')=='center'){ystart/=2;height/=2;}
ystart+=obj.Get('chart.gutter.top')
var x=obj.Get('chart.gutter.left');var y=ystart-height;var w=obj.canvas.width-obj.Get('chart.gutter.left')-obj.Get('chart.gutter.right');var h=height;if(navigator.userAgent.indexOf('Opera')!=-1&&obj.Get('chart.xaxispos')=='center'&&h<0){h*=-1;y=y-h;}
if(obj.Get('chart.xaxispos')=='top'){y=obj.canvas.height-y;h*=-1;}
obj.context.fillStyle=hbars[i][2];obj.context.fillRect(x,y,w,h);}
obj.context.fill();}
RGraph.DrawInGraphLabels=function(obj)
{var canvas=obj.canvas;var context=obj.context;var labels=obj.Get('chart.labels.ingraph');var labels_processed=[];var fgcolor='black';var bgcolor='white';var direction=1;if(!labels){return;}
for(var i=0;i<labels.length;++i){if(typeof(labels[i])=='number'){for(var j=0;j<labels[i];++j){labels_processed.push(null);}}else if(typeof(labels[i])=='string'||typeof(labels[i])=='object'){labels_processed.push(labels[i]);}else{labels_processed.push('');}}
RGraph.NoShadow(obj);if(labels_processed&&labels_processed.length>0){for(var i=0;i<labels_processed.length;++i){if(labels_processed[i]){var coords=obj.coords[i];if(coords&&coords.length>0){var x=(obj.type=='bar'?coords[0]+(coords[2]/2):coords[0]);var y=(obj.type=='bar'?coords[1]+(coords[3]/2):coords[1]);var length=typeof(labels_processed[i][4])=='number'?labels_processed[i][4]:25;context.beginPath();context.fillStyle='black';context.strokeStyle='black';if(obj.type=='bar'){if(obj.Get('chart.xaxispos')=='top'){length*=-1;}
if(obj.Get('chart.variant')=='dot'){context.moveTo(AA(obj,x),obj.coords[i][1]-5);context.lineTo(AA(obj,x),obj.coords[i][1]-5-length);var text_x=AA(obj,x);var text_y=obj.coords[i][1]-5-length;}else if(obj.Get('chart.variant')=='arrow'){context.moveTo(AA(obj,x),obj.coords[i][1]-5);context.lineTo(AA(obj,x),obj.coords[i][1]-5-length);var text_x=AA(obj,x);var text_y=obj.coords[i][1]-5-length;}else{context.arc(AA(obj,x),y,2.5,0,6.28,0);context.moveTo(AA(obj,x),y);context.lineTo(AA(obj,x),y-length);var text_x=AA(obj,x);var text_y=y-length;}
context.stroke();context.fill();}else if(obj.type=='line'){if(typeof(labels_processed[i])=='object'&&typeof(labels_processed[i][3])=='number'&&labels_processed[i][3]==-1){context.moveTo(AA(obj,x),y+5);context.lineTo(AA(obj,x),y+5+length);context.stroke();context.beginPath();context.moveTo(AA(obj,x),y+5);context.lineTo(AA(obj,x)-3,y+10);context.lineTo(AA(obj,x)+3,y+10);context.closePath();var text_x=x;var text_y=y+5+length;}else{var text_x=x;var text_y=y-5-length;context.moveTo(AA(obj,x),y-5);context.lineTo(AA(obj,x),y-5-length);context.stroke();context.beginPath();context.moveTo(AA(obj,x),y-5);context.lineTo(AA(obj,x)-3,y-10);context.lineTo(AA(obj,x)+3,y-10);context.closePath();}
context.fill();}
context.beginPath();context.fillStyle=(typeof(labels_processed[i])=='object'&&typeof(labels_processed[i][1])=='string')?labels_processed[i][1]:'black';RGraph.Text(context,obj.Get('chart.text.font'),obj.Get('chart.text.size'),text_x,text_y,(typeof(labels_processed[i])=='object'&&typeof(labels_processed[i][0])=='string')?labels_processed[i][0]:labels_processed[i],'bottom','center',true,null,(typeof(labels_processed[i])=='object'&&typeof(labels_processed[i][2])=='string')?labels_processed[i][2]:'white');context.fill();}}}}}
RGraph.FixEventObject=function(e)
{if(RGraph.isIE8()||RGraph.isIE7()){var e=event;e.pageX=(event.clientX+document.body.scrollLeft);e.pageY=(event.clientY+document.body.scrollTop);e.target=event.srcElement;if(!document.body.scrollTop&&document.documentElement.scrollTop){e.pageX+=parseInt(document.documentElement.scrollLeft);e.pageY+=parseInt(document.documentElement.scrollTop);}}
if(typeof(e.offsetX)=='undefined'&&typeof(e.offsetY)=='undefined'){var coords=RGraph.getMouseXY(e);e.offsetX=coords[0];e.offsetY=coords[1];}
if(!e.stopPropagation){e.stopPropagation=function(){window.event.cancelBubble=true;}}
return e;}
RGraph.HideCrosshairCoords=function()
{var div=RGraph.Registry.Get('chart.coordinates.coords.div');if(div&&div.style.opacity==1&&div.__object__.Get('chart.crosshairs.coords.fadeout')){setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.9;},50);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.8;},100);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.7;},150);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.6;},200);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.5;},250);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.4;},300);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.3;},350);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.2;},400);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0.1;},450);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.opacity=0;},500);setTimeout(function(){RGraph.Registry.Get('chart.coordinates.coords.div').style.display='none';},550);}}
RGraph.Draw3DAxes=function(obj)
{var gutterLeft=obj.Get('chart.gutter.left');var gutterRight=obj.Get('chart.gutter.right');var gutterTop=obj.Get('chart.gutter.top');var gutterBottom=obj.Get('chart.gutter.bottom');var context=obj.context;var canvas=obj.canvas;context.strokeStyle='#aaa';context.fillStyle='#ddd';context.beginPath();context.moveTo(gutterLeft,gutterTop);context.lineTo(gutterLeft+10,gutterTop-5);context.lineTo(gutterLeft+10,canvas.height-gutterBottom-5);context.lineTo(gutterLeft,canvas.height-gutterBottom);context.closePath();context.stroke();context.fill();context.beginPath();context.moveTo(gutterLeft,canvas.height-gutterBottom);context.lineTo(gutterLeft+10,canvas.height-gutterBottom-5);context.lineTo(canvas.width-gutterRight+10,canvas.height-gutterBottom-5);context.lineTo(canvas.width-gutterRight,canvas.height-gutterBottom);context.closePath();context.stroke();context.fill();}
RGraph.OldBrowserCompat=function(context)
{if(!context){return;}
if(!context.measureText){context.measureText=function(text)
{var textObj=document.createElement('DIV');textObj.innerHTML=text;textObj.style.backgroundColor='white';textObj.style.position='absolute';textObj.style.top=-100
textObj.style.left=0;document.body.appendChild(textObj);var width={width:textObj.offsetWidth};textObj.style.display='none';return width;}}
if(!context.fillText){context.fillText=function(text,targetX,targetY)
{return false;}}
if(!context.canvas.addEventListener){window.addEventListener=function(ev,func,bubble)
{return this.attachEvent('on'+ev,func);}
context.canvas.addEventListener=function(ev,func,bubble)
{return this.attachEvent('on'+ev,func);}}}
RGraph.strokedCurvyRect=function(context,x,y,w,h)
{var r=arguments[5]?arguments[5]:3;var corner_tl=(arguments[6]||arguments[6]==null)?true:false;var corner_tr=(arguments[7]||arguments[7]==null)?true:false;var corner_br=(arguments[8]||arguments[8]==null)?true:false;var corner_bl=(arguments[9]||arguments[9]==null)?true:false;context.beginPath();context.moveTo(x+(corner_tl?r:0),y);context.lineTo(x+w-(corner_tr?r:0),y);if(corner_tr){context.arc(x+w-r,y+r,r,PI+HALFPI,TWOPI,false);}
context.lineTo(x+w,y+h-(corner_br?r:0));if(corner_br){context.arc(x+w-r,y-r+h,r,TWOPI,HALFPI,false);}
context.lineTo(x+(corner_bl?r:0),y+h);if(corner_bl){context.arc(x+r,y-r+h,r,HALFPI,PI,false);}
context.lineTo(x,y+(corner_tl?r:0));if(corner_tl){context.arc(x+r,y+r,r,PI,PI+HALFPI,false);}
context.stroke();}
RGraph.filledCurvyRect=function(context,x,y,w,h)
{var r=arguments[5]?arguments[5]:3;var corner_tl=(arguments[6]||arguments[6]==null)?true:false;var corner_tr=(arguments[7]||arguments[7]==null)?true:false;var corner_br=(arguments[8]||arguments[8]==null)?true:false;var corner_bl=(arguments[9]||arguments[9]==null)?true:false;context.beginPath();if(corner_tl){context.moveTo(x+r,y+r);context.arc(x+r,y+r,r,PI,PI+HALFPI,false);}else{context.fillRect(x,y,r,r);}
if(corner_tr){context.moveTo(x+w-r,y+r);context.arc(x+w-r,y+r,r,PI+HALFPI,0,false);}else{context.moveTo(x+w-r,y);context.fillRect(x+w-r,y,r,r);}
if(corner_br){context.moveTo(x+w-r,y+h-r);context.arc(x+w-r,y-r+h,r,0,HALFPI,false);}else{context.moveTo(x+w-r,y+h-r);context.fillRect(x+w-r,y+h-r,r,r);}
if(corner_bl){context.moveTo(x+r,y+h-r);context.arc(x+r,y-r+h,r,HALFPI,PI,false);}else{context.moveTo(x,y+h-r);context.fillRect(x,y+h-r,r,r);}
context.fillRect(x+r,y,w-r-r,h);context.fillRect(x,y+r,r+1,h-r-r);context.fillRect(x+w-r-1,y+r,r+1,h-r-r);context.fill();}
RGraph.HideZoomedCanvas=function()
{var interval=15;var frames=10;if(typeof(__zoomedimage__)=='object'){obj=__zoomedimage__.obj;}else{return;}
if(obj.Get('chart.zoom.fade.out')){for(var i=frames,j=1;i>=0;--i,++j){if(typeof(__zoomedimage__)=='object'){setTimeout("__zoomedimage__.style.opacity = "+String(i/10),j*interval);}}
if(typeof(__zoomedbackground__)=='object'){setTimeout("__zoomedbackground__.style.opacity = "+String(i/frames),j*interval);}}
if(typeof(__zoomedimage__)=='object'){setTimeout("__zoomedimage__.style.display = 'none'",obj.Get('chart.zoom.fade.out')?(frames*interval)+10:0);}
if(typeof(__zoomedbackground__)=='object'){setTimeout("__zoomedbackground__.style.display = 'none'",obj.Get('chart.zoom.fade.out')?(frames*interval)+10:0);}}
RGraph.AddCustomEventListener=function(obj,name,func)
{if(typeof(RGraph.events[obj.uid])=='undefined'){RGraph.events[obj.uid]=[];}
RGraph.events[obj.uid].push([obj,name,func]);return RGraph.events[obj.uid].length-1;}
RGraph.FireCustomEvent=function(obj,name)
{if(obj&&obj.isRGraph){var uid=obj.uid;if(typeof(uid)=='string'&&typeof(RGraph.events)=='object'&&typeof(RGraph.events[uid])=='object'&&RGraph.events[uid].length>0){for(var j=0;j<RGraph.events[uid].length;++j){if(RGraph.events[uid][j]&&RGraph.events[uid][j][1]==name){RGraph.events[uid][j][2](obj);}}}}}
RGraph.getGutterSuggest=function(obj,data)
{var min=0;for(var i=0;i<data.length;++i){min=Math.min(min,data[i]);}
var min=Math.abs(min);var str=RGraph.number_format(obj,RGraph.array_max(RGraph.getScale(Math.max(min,RGraph.array_max(data)),obj)),obj.Get('chart.units.pre'),obj.Get('chart.units.post'));if(obj.type=='hbar'){var str='';var len=0;for(var i=0;i<obj.Get('chart.labels').length;++i){str=(obj.Get('chart.labels').length>str.length?obj.Get('chart.labels')[i]:str);}}
obj.context.font=obj.Get('chart.text.size')+'pt '+obj.Get('chart.text.font');len=obj.context.measureText(str).width+5;return(obj.type=='hbar'?len/3:len);}
RGraph.SetConfig=function(obj,c)
{for(i in c){if(typeof(i)=='string'){obj.Set(i,c[i]);}}
return obj;}
RGraph.RemoveAllCustomEventListeners=function()
{var id=arguments[0];if(id&&RGraph.events[id]){RGraph.events[id]=[];}else{RGraph.events=[];}}
RGraph.RemoveCustomEventListener=function(obj,i)
{if(typeof(RGraph.events)=='object'&&typeof(RGraph.events[obj.id])=='object'&&typeof(RGraph.events[obj.id][i])=='object'){RGraph.events[obj.id][i]=null;}}
RGraph.DrawBackgroundImage=function(obj)
{if(typeof(obj.Get('chart.background.image'))=='string'){if(typeof(obj.canvas.__rgraph_background_image__)=='undefined'){var img=new Image();img.__object__=obj;img.__canvas__=obj.canvas;img.__context__=obj.context;img.src=obj.Get('chart.background.image');obj.canvas.__rgraph_background_image__=img;}else{img=obj.canvas.__rgraph_background_image__;}
img.onload=function()
{RGraph.Clear(obj.canvas);RGraph.RedrawCanvas(obj.canvas);}
var gutterLeft=obj.Get('chart.gutter.left');var gutterRight=obj.Get('chart.gutter.right');var gutterTop=obj.Get('chart.gutter.top');var gutterBottom=obj.Get('chart.gutter.bottom');var stretch=obj.Get('chart.background.image.stretch');var align=obj.Get('chart.background.image.align');if(typeof(align)=='string'){if(align.indexOf('right')!=-1){var x=obj.canvas.width-img.width-gutterRight;}else{var x=gutterLeft;}
if(align.indexOf('bottom')!=-1){var y=obj.canvas.height-img.height-gutterBottom;}else{var y=gutterTop;}}else{var x=gutterLeft;var y=gutterTop;}
var x=typeof(obj.Get('chart.background.image.x'))=='number'?obj.Get('chart.background.image.x'):x;var y=typeof(obj.Get('chart.background.image.y'))=='number'?obj.Get('chart.background.image.y'):y;var w=stretch?obj.canvas.width-gutterLeft-gutterRight:img.width;var h=stretch?obj.canvas.height-gutterTop-gutterBottom:img.height;if(typeof(obj.Get('chart.background.image.w'))=='number')w=obj.Get('chart.background.image.w');if(typeof(obj.Get('chart.background.image.h'))=='number')h=obj.Get('chart.background.image.h');obj.context.drawImage(img,x,y,w,h);}}
RGraph.hasTooltips=function(obj)
{if(typeof(obj.Get('chart.tooltips'))=='object'&&obj.Get('chart.tooltips')){for(var i=0;i<obj.Get('chart.tooltips').length;++i){if(!RGraph.is_null(obj.Get('chart.tooltips')[i])){return true;}}}else if(typeof(obj.Get('chart.tooltips'))=='function'){return true;}
return false;}
RGraph.CreateUID=function()
{return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c)
{var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});}
RGraph.ObjectRegistry.Add=function(obj)
{var uid=obj.uid;var canvasID=obj.canvas.id;RGraph.ObjectRegistry.objects.byUID.push([uid,obj]);RGraph.ObjectRegistry.objects.byCanvasID.push([canvasID,obj]);}
RGraph.ObjectRegistry.Remove=function(obj)
{var id=obj.id;var uid=obj.uid;for(var i=0;i<RGraph.ObjectRegistry.objects.byUID.length;++i){if(RGraph.ObjectRegistry.objects.byUID[i]&&RGraph.ObjectRegistry.objects.byUID[i][1].uid==uid){RGraph.ObjectRegistry.objects.byUID[i]=null;}}
for(var i=0;i<RGraph.ObjectRegistry.objects.byCanvasID.length;++i){if(RGraph.ObjectRegistry.objects.byCanvasID[i]&&RGraph.ObjectRegistry.objects.byCanvasID[i][0]==id){RGraph.ObjectRegistry.objects.byCanvasID[i]=null;}}}
RGraph.ObjectRegistry.Clear=function()
{if(arguments[0]){var id=(typeof(arguments[0])=='object'?arguments[0].id:arguments[0]);var objects=RGraph.ObjectRegistry.getObjectsByCanvasID(id);for(var i=0;i<objects.length;++i){RGraph.ObjectRegistry.Remove(objects[i]);}}else{RGraph.ObjectRegistry.objects={};RGraph.ObjectRegistry.objects.byUID=[];RGraph.ObjectRegistry.objects.byCanvasID=[];}}
RGraph.ObjectRegistry.getObjectsByCanvasID=function(id)
{var store=RGraph.ObjectRegistry.objects.byCanvasID;var ret=[];for(var i=0;i<store.length;++i){if(store[i]&&store[i][0]==id){ret.push(store[i][1]);}}
return ret;}
RGraph.ObjectRegistry.getFirstObjectByXY=RGraph.ObjectRegistry.getObjectByXY=function(e)
{var canvas=e.target;var ret=null;var objects=RGraph.ObjectRegistry.getObjectsByCanvasID(canvas.id);for(var i=(objects.length-1);i>=0;--i){var obj=objects[i].getObjectByXY(e);if(obj){return obj;}}}
RGraph.ObjectRegistry.getObjectsByXY=function(e)
{var canvas=e.target;var ret=[];var objects=RGraph.ObjectRegistry.getObjectsByCanvasID(canvas.id);for(var i=(objects.length-1);i>=0;--i){var obj=objects[i].getObjectByXY(e);if(obj){ret.push(obj);}}
return ret;}
RGraph.ObjectRegistry.getObjectByUID=function(uid)
{var objects=RGraph.ObjectRegistry.objects.byUID;for(var i=0;i<objects.length;++i){if(objects[i]&&objects[i][1].uid==uid){return objects[i][1];}}}
RGraph.ObjectRegistry.getObjectsByType=function(canvas,type)
{if(typeof(canvas)=='string'){canvas=document.getElementById(canvas);}
var objects=RGraph.ObjectRegistry.getObjectsByCanvasID(canvas.id);var ret=[];for(var i=0;i<objects.length;++i){if(objects[i]&&objects[i].type&&objects[i].type==type){ret.push(objects[i]);}}
return ret;}
RGraph.ObjectRegistry.getFirstObjectByType=function(canvas,type)
{var objects=RGraph.ObjectRegistry.getObjectsByType(canvas,type);return objects.length>0?objects[0]:null;}
RGraph.getAngleByXY=function(cx,cy,x,y)
{var angle=Math.atan((y-cy)/(x-cx));angle=Math.abs(angle)
if(x>=cx&&y>=cy){angle+=TWOPI;}else if(x>=cx&&y<cy){angle=(HALFPI-angle)+(PI+HALFPI);}else if(x<cx&&y<cy){angle+=PI;}else{angle=PI-angle;}
if(angle>TWOPI){angle-=TWOPI;}
return angle;}
RGraph.getHypLength=function(x1,y1,x2,y2)
{var ret=Math.sqrt(((x2-x1)*(x2-x1))+((y2-y1)*(y2-y1)));return ret;}
RGraph.InstallEventListeners=function(obj)
{if(RGraph.isOld()){return;}
if(RGraph.InstallCanvasClickListener){RGraph.InstallWindowMousedownListener(obj);RGraph.InstallWindowMouseupListener(obj);RGraph.InstallCanvasMousemoveListener(obj);RGraph.InstallCanvasMouseupListener(obj);RGraph.InstallCanvasMousedownListener(obj);RGraph.InstallCanvasClickListener(obj);}else if(RGraph.hasTooltips(obj)||obj.Get('chart.adjustable')||obj.Get('chart.annotatable')||obj.Get('chart.contextmenu')||obj.Get('chart.resizable')||obj.Get('chart.key.interactive')||obj.Get('chart.events.click')||obj.Get('chart.events.mousemove')){alert('[RGRAPH] You appear to have used dynamic features but not included the file: RGraph.common.dynamic.js');}}
RGraph.pr=function(obj)
{var str='';var indent=(arguments[2]?arguments[2]:'');switch(typeof(obj)){case'number':if(indent==''){str+='Number: '}
str+=String(obj);break;case'string':if(indent==''){str+='String ('+obj.length+'):'}
str+='"'+String(obj)+'"';break;case'object':if(obj==null){str+='null';break;}
str+='Object\n'+indent+'(\n';for(var i in obj){if(typeof(i)=='string'||typeof(i)=='number'){str+=indent+' '+i+' => '+RGraph.pr(obj[i],true,indent+'    ')+'\n';}}
var str=str+indent+')';break;case'function':str+=obj;break;case'boolean':str+='Boolean: '+(obj?'true':'false');break;}
if(arguments[1]){return str;}else{alert(str);}}
RGraph.DashedLine=function(context,x1,y1,x2,y2)
{var size=5;if(typeof(arguments[5])=='number'){size=arguments[5];}
var dx=x2-x1;var dy=y2-y1;var num=Math.floor(Math.sqrt((dx*dx)+(dy*dy))/size);var xLen=dx/num;var yLen=dy/num;var count=0;do{count%2==0?context.lineTo(x1,y1):context.moveTo(x1,y1);x1+=xLen;y1+=yLen;}while(count++<num);}
RGraph.AJAX=function(url,callback)
{if(window.XMLHttpRequest){var httpRequest=new XMLHttpRequest();}else if(window.ActiveXObject){var httpRequest=new ActiveXObject("Microsoft.XMLHTTP");}
httpRequest.onreadystatechange=function()
{if(this.readyState==4&&this.status==200){this.__user_callback__=callback;this.__user_callback__();}}
httpRequest.open('GET',url,true);httpRequest.send();}
RGraph.RotateCanvas=function(canvas,x,y,angle)
{var context=canvas.getContext('2d');context.translate(x,y);context.rotate(angle);context.translate(0-x,0-y);}
function AA(obj,value){var value=String(value).replace(/^(\d+)\.\d+/,'$1');var newvalue=Number(value)+0.5;return(newvalue-value)>=0?newvalue:Math.floor(value);}
RGraph.LinearGradient=function(obj,x1,y1,x2,y2,color1,color2){var gradient=obj.context.createLinearGradient(x1,y1,x2,y2);gradient.addColorStop(0,color1);gradient.addColorStop(1,color2);return gradient;}
RGraph.RadialGradient=function(obj,x1,y1,r1,x2,y2,r2,color1,color2){var gradient=obj.context.createRadialGradient(x1,y1,r1,x2,y2,r2);gradient.addColorStop(0,color1);gradient.addColorStop(1,color2);return gradient;}
RGraph.array_shift=function(arr){var ret=[];for(var i=1;i<arr.length;++i){ret.push(arr[i]);}return ret;}
RGraph.AddEventListener=function(id,e,func){var type=arguments[3]?arguments[3]:'unknown';RGraph.Registry.Get('chart.event.handlers').push([id,e,func,type]);}
RGraph.ClearEventListeners=function(id){}
RGraph.HidePalette=function(){var div=RGraph.Registry.Get('palette');if(typeof(div)=='object'&&div){div.style.visibility='hidden';div.style.display='none';RGraph.Registry.Set('palette',null);}}
RGraph.random=function(min,max){var dp=arguments[2]?arguments[2]:0;var r=Math.random();return Number((((max-min)*r)+min).toFixed(dp));}
RGraph.NoShadow=function(obj){obj.context.shadowColor='rgba(0,0,0,0)';obj.context.shadowBlur=0;obj.context.shadowOffsetX=0;obj.context.shadowOffsetY=0;}
RGraph.SetShadow=function(obj,color,offsetx,offsety,blur){obj.context.shadowColor=color;obj.context.shadowOffsetX=offsetx;obj.context.shadowOffsetY=offsety;obj.context.shadowBlur=blur;}
RGraph.array_reverse=function(arr){var newarr=[];for(var i=arr.length-1;i>=0;i--){newarr.push(arr[i]);}return newarr;}
RGraph.Registry.Set=function(name,value){RGraph.Registry.store[name]=value;return value;}
RGraph.Registry.Get=function(name){return RGraph.Registry.store[name];}
RGraph.degrees2Radians=function(degrees){return degrees*(PI/180);}
RGraph.is_array=function(obj){return obj!=null&&obj.constructor.toString().indexOf('Array')!=-1;}
RGraph.trim=function(str){return RGraph.ltrim(RGraph.rtrim(str));}
RGraph.ltrim=function(str){return str.replace(/^(\s|\0)+/,'');}
RGraph.rtrim=function(str){return str.replace(/(\s|\0)+$/,'');}
RGraph.GetHeight=function(obj){return obj.canvas.height;}
RGraph.GetWidth=function(obj){return obj.canvas.width;}
RGraph.is_null=function(arg){if(arg==null||(typeof(arg))=='object'&&!arg){return true;}return false;}
RGraph.Timer=function(label){var d=new Date();console.log(label+': '+d.getSeconds()+'.'+d.getMilliseconds());}
RGraph.Async=function(func){return setTimeout(func,arguments[1]?arguments[1]:1);}
RGraph.isIE7=function(){return navigator.userAgent.indexOf('MSIE 7')>0;}
RGraph.isIE8=function(){return navigator.userAgent.indexOf('MSIE 8')>0;}
RGraph.isIE9=function(){return navigator.userAgent.indexOf('MSIE 9')>0;}
RGraph.isIE9up=function(){navigator.userAgent.match(/MSIE (\d+)/);return Number(RegExp.$1)>=9;}
RGraph.isOld=function(){return RGraph.isIE7()||RGraph.isIE8();}
RGraph.Reset=function(canvas){canvas.width=canvas.width;}
function pd(variable){RGraph.pr(variable);}
function p(variable){RGraph.pr(variable);}
function a(variable){alert(variable);}
function cl(variable){return console.log(variable);}
if(typeof(RGraph)=='undefined')RGraph={};RGraph.Bar=function(id,data)
{this.id=id;this.canvas=document.getElementById(id);this.context=this.canvas.getContext?this.canvas.getContext("2d"):null;this.canvas.__object__=this;this.type='bar';this.max=0;this.stackedOrGrouped=false;this.isRGraph=true;this.uid=RGraph.CreateUID();this.canvas.uid=this.canvas.uid?this.canvas.uid:RGraph.CreateUID();RGraph.OldBrowserCompat(this.context);this.properties={'chart.background.barcolor1':'rgba(0,0,0,0)','chart.background.barcolor2':'rgba(0,0,0,0)','chart.background.grid':true,'chart.background.grid.color':'#ddd','chart.background.grid.width':1,'chart.background.grid.hsize':20,'chart.background.grid.vsize':20,'chart.background.grid.vlines':true,'chart.background.grid.hlines':true,'chart.background.grid.border':true,'chart.background.grid.autofit':true,'chart.background.grid.autofit.numhlines':5,'chart.background.grid.autofit.numvlines':20,'chart.background.image.stretch':true,'chart.background.image.x':null,'chart.background.image.y':null,'chart.background.image.w':null,'chart.background.image.h':null,'chart.background.image.align':null,'chart.ytickgap':20,'chart.smallyticks':3,'chart.largeyticks':5,'chart.numyticks':10,'chart.hmargin':5,'chart.hmargin.grouped':1,'chart.strokecolor':'rgba(0,0,0,0)','chart.axis.color':'black','chart.gutter.top':25,'chart.gutter.bottom':25,'chart.gutter.left':25,'chart.gutter.right':25,'chart.labels':null,'chart.labels.ingraph':null,'chart.labels.above':false,'chart.labels.above.decimals':0,'chart.labels.above.size':null,'chart.labels.above.angle':null,'chart.ylabels':true,'chart.ylabels.count':5,'chart.ylabels.inside':false,'chart.xlabels.offset':0,'chart.xaxispos':'bottom','chart.yaxispos':'left','chart.text.color':'black','chart.text.size':10,'chart.text.angle':0,'chart.text.font':'Arial','chart.ymin':0,'chart.ymax':null,'chart.title':'','chart.title.font':null,'chart.title.background':null,'chart.title.hpos':null,'chart.title.vpos':null,'chart.title.bold':true,'chart.title.xaxis':'','chart.title.xaxis.bold':true,'chart.title.xaxis.size':null,'chart.title.xaxis.font':null,'chart.title.yaxis':'','chart.title.yaxis.bold':true,'chart.title.yaxis.size':null,'chart.title.yaxis.font':null,'chart.title.xaxis.pos':null,'chart.title.yaxis.pos':null,'chart.colors':['#01B4FF','#0f0','#00f','#ff0','#0ff','#0f0'],'chart.colors.sequential':false,'chart.colors.reverse':false,'chart.grouping':'grouped','chart.variant':'bar','chart.shadow':false,'chart.shadow.color':'#999','chart.shadow.offsetx':3,'chart.shadow.offsety':3,'chart.shadow.blur':3,'chart.tooltips':null,'chart.tooltips.effect':'fade','chart.tooltips.css.class':'RGraph_tooltip','chart.tooltips.event':'onclick','chart.tooltips.highlight':true,'chart.highlight.stroke':'rgba(0,0,0,0)','chart.highlight.fill':'rgba(255,255,255,0.7)','chart.background.hbars':null,'chart.key':null,'chart.key.background':'white','chart.key.position':'graph','chart.key.shadow':false,'chart.key.shadow.color':'#666','chart.key.shadow.blur':3,'chart.key.shadow.offsetx':2,'chart.key.shadow.offsety':2,'chart.key.position.gutter.boxed':true,'chart.key.position.x':null,'chart.key.position.y':null,'chart.key.halign':'right','chart.key.color.shape':'square','chart.key.rounded':true,'chart.key.text.size':10,'chart.key.linewidth':1,'chart.key.colors':null,'chart.contextmenu':null,'chart.units.pre':'','chart.units.post':'','chart.scale.decimals':0,'chart.scale.point':'.','chart.scale.thousand':',','chart.crosshairs':false,'chart.crosshairs.color':'#333','chart.crosshairs.hline':true,'chart.crosshairs.vline':true,'chart.linewidth':1,'chart.annotatable':false,'chart.annotate.color':'black','chart.zoom.factor':1.5,'chart.zoom.fade.in':true,'chart.zoom.fade.out':true,'chart.zoom.hdir':'right','chart.zoom.vdir':'down','chart.zoom.frames':25,'chart.zoom.delay':16.666,'chart.zoom.shadow':true,'chart.zoom.background':true,'chart.resizable':false,'chart.resize.handle.adjust':[0,0],'chart.resize.handle.background':null,'chart.adjustable':false,'chart.noaxes':false,'chart.noxaxis':false,'chart.noyaxis':false,'chart.events.click':null,'chart.events.mousemove':null,'chart.numxticks':null}
if(!this.canvas){alert('[BAR] No canvas support');return;}
for(i=0;i<data.length;++i){if(typeof(data[i])=='object'){this.stackedOrGrouped=true;}}
this.data=data;this.coords=[];this.data_arr=RGraph.array_linearize(this.data);RGraph.Register(this);}
RGraph.Bar.prototype.Set=function(name,value)
{name=name.toLowerCase();if(name=='chart.labels.abovebar'){name='chart.labels.above';}
if(name=='chart.strokestyle'){name='chart.strokecolor';}
if(name=='chart.xaxispos'){if(value!='bottom'&&value!='center'&&value!='top'){alert('[BAR] ('+this.id+') chart.xaxispos should be top, center or bottom. Tried to set it to: '+value+' Changing it to center');value='center';}
if(value=='top'){for(var i=0;i<this.data.length;++i){if(typeof(this.data[i])=='number'&&this.data[i]>0){alert('[BAR] The data element with index '+i+' should be negative');}}}}
if(name.toLowerCase()=='chart.linewidth'&&value==0){value=0.0001;}
this.properties[name]=value;}
RGraph.Bar.prototype.Get=function(name)
{if(name=='chart.labels.abovebar'){name='chart.labels.above';}
var value=this.properties[name];return value;}
RGraph.Bar.prototype.Draw=function()
{if(typeof(this.Get('chart.background.image'))=='string'){RGraph.DrawBackgroundImage(this);}
RGraph.FireCustomEvent(this,'onbeforedraw');this.gutterLeft=this.Get('chart.gutter.left');this.gutterRight=this.Get('chart.gutter.right');this.gutterTop=this.Get('chart.gutter.top');this.gutterBottom=this.Get('chart.gutter.bottom');for(var i=0;i<this.data.length;++i){if(this.data[i]==null){this.data[i]=0;}}
if((this.Get('chart.variant')=='pyramid'||this.Get('chart.variant')=='dot')&&typeof(this.Get('chart.tooltips'))=='object'&&this.Get('chart.tooltips')&&this.Get('chart.tooltips').length>0){alert('[BAR] ('+this.id+') Sorry, tooltips are not supported with dot or pyramid charts');}
this.coords=[];this.max=0;this.grapharea=this.canvas.height-this.gutterTop-this.gutterBottom;this.halfgrapharea=this.grapharea/2;this.halfTextHeight=this.Get('chart.text.size')/2;RGraph.background.Draw(this);if(this.Get('chart.variant')=='sketch'){this.DrawAxes();this.Drawbars();}else{this.Drawbars();this.DrawAxes();}
this.DrawLabels();if(this.Get('chart.key')&&this.Get('chart.key').length){RGraph.DrawKey(this,this.Get('chart.key'),this.Get('chart.colors'));}
if(this.Get('chart.contextmenu')){RGraph.ShowContext(this);}
if(this.Get('chart.labels.ingraph')){RGraph.DrawInGraphLabels(this);}
if(this.Get('chart.resizable')){RGraph.AllowResizing(this);}
RGraph.InstallEventListeners(this);RGraph.FireCustomEvent(this,'ondraw');}
RGraph.Bar.prototype.DrawAxes=function()
{if(this.Get('chart.noaxes')){return;}
var xaxispos=this.Get('chart.xaxispos');var yaxispos=this.Get('chart.yaxispos');this.context.beginPath();this.context.strokeStyle=this.Get('chart.axis.color');this.context.lineWidth=1;if(this.Get('chart.noyaxis')==false){if(yaxispos=='right'){this.context.moveTo(AA(this,this.canvas.width-this.gutterRight),this.gutterTop);this.context.lineTo(AA(this,this.canvas.width-this.gutterRight),this.canvas.height-this.gutterBottom);}else{this.context.moveTo(AA(this,this.gutterLeft),this.gutterTop);this.context.lineTo(AA(this,this.gutterLeft),this.canvas.height-this.gutterBottom);}}
if(this.Get('chart.noxaxis')==false){if(xaxispos=='center'){this.context.moveTo(this.gutterLeft,AA(this,((this.canvas.height-this.gutterTop-this.gutterBottom)/2)+this.gutterTop));this.context.lineTo(this.canvas.width-this.gutterRight,AA(this,((this.canvas.height-this.gutterTop-this.gutterBottom)/2)+this.gutterTop));}else if(xaxispos=='top'){this.context.moveTo(this.gutterLeft,AA(this,this.gutterTop));this.context.lineTo(this.canvas.width-this.gutterRight,AA(this,this.gutterTop));}else{this.context.moveTo(this.gutterLeft,AA(this,this.canvas.height-this.gutterBottom));this.context.lineTo(this.canvas.width-this.gutterRight,AA(this,this.canvas.height-this.gutterBottom));}}
var numYTicks=this.Get('chart.numyticks');if(this.Get('chart.noyaxis')==false){var yTickGap=(this.canvas.height-this.gutterTop-this.gutterBottom)/numYTicks;var xpos=yaxispos=='left'?this.gutterLeft:this.canvas.width-this.gutterRight;if(this.Get('chart.numyticks')>0){for(y=this.gutterTop;xaxispos=='center'?y<=(this.canvas.height-this.gutterBottom):y<(this.canvas.height-this.gutterBottom+(xaxispos=='top'?1:0));y+=yTickGap){if(xaxispos=='center'&&y==(this.canvas.height/2))continue;if(xaxispos=='top'&&y==this.gutterTop)continue;this.context.moveTo(xpos,AA(this,y));this.context.lineTo(xpos+(yaxispos=='left'?-3:3),AA(this,y));}}
if(this.Get('chart.noxaxis')){if(xaxispos=='center'){this.context.moveTo(xpos+(yaxispos=='left'?-3:3),AA(this,this.canvas.height/2));this.context.lineTo(xpos,AA(this,this.canvas.height/2));}else if(xaxispos=='top'){this.context.moveTo(xpos+(yaxispos=='left'?-3:3),AA(this,this.gutterTop));this.context.lineTo(xpos,AA(this,this.gutterTop));}else{this.context.moveTo(xpos+(yaxispos=='left'?-3:3),AA(this,this.canvas.height-this.gutterBottom));this.context.lineTo(xpos,AA(this,this.canvas.height-this.gutterBottom));}}}
if(this.Get('chart.noxaxis')==false){xTickGap=(this.canvas.width-this.gutterLeft-this.gutterRight)/this.data.length;if(typeof(this.Get('chart.numxticks'))=='number'){xTickGap=(this.canvas.width-this.gutterLeft-this.gutterRight)/this.Get('chart.numxticks');}
if(xaxispos=='bottom'){yStart=this.canvas.height-this.gutterBottom;yEnd=(this.canvas.height-this.gutterBottom)+3;}else if(xaxispos=='top'){yStart=this.gutterTop-3;yEnd=this.gutterTop;}else if(xaxispos=='center'){yStart=((this.canvas.height-this.gutterTop-this.gutterBottom)/2)+this.gutterTop+3;yEnd=((this.canvas.height-this.gutterTop-this.gutterBottom)/2)+this.gutterTop-3;}
yStart=AA(this,yStart);yEnd=AA(this,yEnd);var noEndXTick=this.Get('chart.noendxtick');for(x=this.gutterLeft+(yaxispos=='left'?xTickGap:0);x<this.canvas.width-this.gutterRight+(yaxispos=='left'?5:0);x+=xTickGap){if(yaxispos=='left'&&!noEndXTick&&x>this.gutterLeft){this.context.moveTo(AA(this,x),yStart);this.context.lineTo(AA(this,x),yEnd);}else if(yaxispos=='left'&&noEndXTick&&x>this.gutterLeft&&x<(this.canvas.width-this.gutterRight)){this.context.moveTo(AA(this,x),yStart);this.context.lineTo(AA(this,x),yEnd);}else if(yaxispos=='right'&&x<(this.canvas.width-this.gutterRight)&&!noEndXTick){this.context.moveTo(AA(this,x),yStart);this.context.lineTo(AA(this,x),yEnd);}else if(yaxispos=='right'&&x<(this.canvas.width-this.gutterRight)&&x>(this.gutterLeft)&&noEndXTick){this.context.moveTo(AA(this,x),yStart);this.context.lineTo(AA(this,x),yEnd);}}
if(this.Get('chart.noyaxis')||this.Get('chart.numxticks')==null){if(typeof(this.Get('chart.numxticks'))=='number'&&this.Get('chart.numxticks')>0){this.context.moveTo(AA(this,this.gutterLeft),yStart);this.context.lineTo(AA(this,this.gutterLeft),yEnd);}}}
if(this.Get('chart.noyaxis')&&this.Get('chart.noxaxis')==false&&this.Get('chart.numxticks')==null){if(xaxispos=='center'){this.context.moveTo(AA(this,this.gutterLeft),(this.canvas.height/2)-3);this.context.lineTo(AA(this,this.gutterLeft),(this.canvas.height/2)+3);}else{this.context.moveTo(AA(this,this.gutterLeft),this.canvas.height-this.gutterBottom);this.context.lineTo(AA(this,this.gutterLeft),this.canvas.height-this.gutterBottom+3);}}
this.context.stroke();}
RGraph.Bar.prototype.Drawbars=function()
{this.context.lineWidth=this.Get('chart.linewidth');this.context.strokeStyle=this.Get('chart.strokecolor');this.context.fillStyle=this.Get('chart.colors')[0];var prevX=0;var prevY=0;var decimals=this.Get('chart.scale.decimals');if(this.Get('chart.ymax')){this.max=this.Get('chart.ymax');this.min=this.Get('chart.ymin');this.scale=[(((this.max-this.min)*(1/5))+this.min).toFixed(decimals),(((this.max-this.min)*(2/5))+this.min).toFixed(decimals),(((this.max-this.min)*(3/5))+this.min).toFixed(decimals),(((this.max-this.min)*(4/5))+this.min).toFixed(decimals),(((this.max-this.min)*(5/5)+this.min)).toFixed(decimals)];}else{this.min=this.Get('chart.ymin');for(i=0;i<this.data.length;++i){if(typeof(this.data[i])=='object'){var value=this.Get('chart.grouping')=='grouped'?Number(RGraph.array_max(this.data[i],true)):Number(RGraph.array_sum(this.data[i]));}else{var value=Number(this.data[i]);}
this.max=Math.max(Math.abs(this.max),Math.abs(value));}
this.scale=RGraph.getScale(this.max,this);this.max=this.scale[4];if(this.Get('chart.ymin')){var decimals=this.Get('chart.scale.decimals');this.scale[0]=((Number(this.scale[4]-this.min)*0.2)+this.min).toFixed(decimals);this.scale[1]=((Number(this.scale[4]-this.min)*0.4)+this.min).toFixed(decimals);this.scale[2]=((Number(this.scale[4]-this.min)*0.6)+this.min).toFixed(decimals);this.scale[3]=((Number(this.scale[4]-this.min)*0.8)+this.min).toFixed(decimals);this.scale[4]=((Number(this.scale[4]-this.min)*1.0)+this.min).toFixed(decimals);}else{if(this.Get('chart.scale.decimals')){var decimals=this.Get('chart.scale.decimals');this.scale[0]=Number(this.scale[0]).toFixed(decimals);this.scale[1]=Number(this.scale[1]).toFixed(decimals);this.scale[2]=Number(this.scale[2]).toFixed(decimals);this.scale[3]=Number(this.scale[3]).toFixed(decimals);this.scale[4]=Number(this.scale[4]).toFixed(decimals);}}}
if(this.Get('chart.adjustable')&&!this.Get('chart.ymax')){this.Set('chart.ymax',this.scale[4]);}
if(this.Get('chart.background.hbars')&&this.Get('chart.background.hbars').length>0){RGraph.DrawBars(this);}
var variant=this.Get('chart.variant');if(variant=='3d'){RGraph.Draw3DAxes(this);}
var xaxispos=this.Get('chart.xaxispos');var width=(this.canvas.width-this.gutterLeft-this.gutterRight)/this.data.length;var orig_height=height;var hmargin=this.Get('chart.hmargin');var shadow=this.Get('chart.shadow');var shadowColor=this.Get('chart.shadow.color');var shadowBlur=this.Get('chart.shadow.blur');var shadowOffsetX=this.Get('chart.shadow.offsetx');var shadowOffsetY=this.Get('chart.shadow.offsety');var strokeStyle=this.Get('chart.strokecolor');var colors=this.Get('chart.colors');var sequentialColorIndex=0;for(i=0;i<this.data.length;++i){var height=((RGraph.array_sum(this.data[i])<0?RGraph.array_sum(this.data[i])+this.min:RGraph.array_sum(this.data[i])-this.min)/(this.max-this.min))*(this.canvas.height-this.gutterTop-this.gutterBottom);if(xaxispos=='center'){height/=2;}
var x=(i*width)+this.gutterLeft;var y=xaxispos=='center'?((this.canvas.height-this.gutterTop-this.gutterBottom)/2)+this.gutterTop-height:this.canvas.height-height-this.gutterBottom;if(xaxispos=='top'){y=this.gutterTop+Math.abs(height);}
if(height<0){y+=height;height=Math.abs(height);}
if(shadow){this.context.shadowColor=shadowColor;this.context.shadowBlur=shadowBlur;this.context.shadowOffsetX=shadowOffsetX;this.context.shadowOffsetY=shadowOffsetY;}
this.context.beginPath();if(typeof(this.data[i])=='number'){var barWidth=width-(2*hmargin);if(barWidth<0){alert('[RGRAPH] Warning: you have a negative bar width. This may be caused by the chart.hmargin being too high or the width of the canvas not being sufficient.');}
this.context.strokeStyle=strokeStyle;this.context.fillStyle=colors[0];if(this.Get('chart.colors.sequential')){this.context.fillStyle=colors[i];}
if(variant=='sketch'){this.context.lineCap='round';var sketchOffset=3;this.context.beginPath();this.context.strokeStyle=colors[0];if(this.Get('chart.colors.sequential')){this.context.strokeStyle=colors[i];}
this.context.moveTo(x+hmargin+2,y+height-2);this.context.lineTo(x+hmargin,y-2);this.context.moveTo(x+hmargin-3,y+-2+(this.data[i]<0?height:0));this.context.bezierCurveTo(x+((hmargin+width)*0.33),y+5+(this.data[i]<0?height-10:0),x+((hmargin+width)*0.66),y+5+(this.data[i]<0?height-10:0),x+hmargin+width+-1,y+0+(this.data[i]<0?height:0));this.context.moveTo(x+hmargin+width-2,y+-2);this.context.lineTo(x+hmargin+width-3,y+height-3);for(var r=0.2;r<=0.8;r+=0.2){this.context.moveTo(x+hmargin+width+(r>0.4?-1:3)-(r*width),y-1);this.context.lineTo(x+hmargin+width-(r>0.4?1:-1)-(r*width),y+height+(r==0.2?1:-2));}
this.context.stroke();}else if(variant=='bar'||variant=='3d'||variant=='glass'||variant=='bevel'){if(RGraph.isOld()&&shadow){this.DrawIEShadow([x+hmargin,y,barWidth,height]);}
if(variant=='glass'){RGraph.filledCurvyRect(this.context,x+hmargin,y,barWidth,height,3,this.data[i]>0,this.data[i]>0,this.data[i]<0,this.data[i]<0);RGraph.strokedCurvyRect(this.context,x+hmargin,y,barWidth,height,3,this.data[i]>0,this.data[i]>0,this.data[i]<0,this.data[i]<0);}else{this.context.strokeRect(x+hmargin,y,barWidth,height);this.context.fillRect(x+hmargin,y,barWidth,height);}
if(variant=='3d'){var prevStrokeStyle=this.context.strokeStyle;var prevFillStyle=this.context.fillStyle;this.context.beginPath();this.context.moveTo(x+hmargin,y);this.context.lineTo(x+hmargin+10,y-5);this.context.lineTo(x+hmargin+10+barWidth,y-5);this.context.lineTo(x+hmargin+barWidth,y);this.context.closePath();this.context.stroke();this.context.fill();this.context.beginPath();this.context.moveTo(x+hmargin+barWidth,y);this.context.lineTo(x+hmargin+barWidth+10,y-5);this.context.lineTo(x+hmargin+barWidth+10,y+height-5);this.context.lineTo(x+hmargin+barWidth,y+height);this.context.closePath();this.context.stroke();this.context.fill();this.context.beginPath();this.context.fillStyle='rgba(255,255,255,0.3)';this.context.moveTo(x+hmargin,y);this.context.lineTo(x+hmargin+10,y-5);this.context.lineTo(x+hmargin+10+barWidth,y-5);this.context.lineTo(x+hmargin+barWidth,y);this.context.lineTo(x+hmargin,y);this.context.closePath();this.context.stroke();this.context.fill();this.context.beginPath();this.context.fillStyle='rgba(0,0,0,0.4)';this.context.moveTo(x+hmargin+barWidth,y);this.context.lineTo(x+hmargin+barWidth+10,y-5);this.context.lineTo(x+hmargin+barWidth+10,y-5+height);this.context.lineTo(x+hmargin+barWidth,y+height);this.context.lineTo(x+hmargin+barWidth,y);this.context.closePath();this.context.stroke();this.context.fill();this.context.strokeStyle=prevStrokeStyle;this.context.fillStyle=prevFillStyle;}else if(variant=='glass'){var grad=this.context.createLinearGradient(x+hmargin,y,x+hmargin+(barWidth/2),y);grad.addColorStop(0,'rgba(255,255,255,0.9)');grad.addColorStop(1,'rgba(255,255,255,0.5)');this.context.beginPath();this.context.fillStyle=grad;this.context.fillRect(x+hmargin+2,y+(this.data[i]>0?2:0),(barWidth/2)-2,height-2);this.context.fill();}
if(this.Get('chart.labels.above')){if(shadow){RGraph.NoShadow(this);}
var yPos=y-3;if(this.data[i]<0){yPos+=height+6+(this.Get('chart.text.size')-4);}
if(this.Get('chart.xaxispos')=='top'){yPos=this.gutterTop+height+6+(typeof(this.Get('chart.labels.above.size'))=='number'?this.Get('chart.labels.above.size'):this.Get('chart.text.size')-4);}
if(this.Get('chart.variant')=='3d'){yPos-=5;}
this.context.fillStyle=this.Get('chart.text.color');RGraph.Text(this.context,this.Get('chart.text.font'),typeof(this.Get('chart.labels.above.size'))=='number'?this.Get('chart.labels.above.size'):this.Get('chart.text.size')-3,x+hmargin+(barWidth/2),yPos,RGraph.number_format(this,Number(this.data[i]).toFixed(this.Get('chart.labels.above.decimals')),this.Get('chart.units.pre'),this.Get('chart.units.post')),this.Get('chart.labels.above.angle')?'bottom':null,this.Get('chart.labels.above.angle')?(this.Get('chart.labels.above.angle')>0&&(this.Get('chart.xaxispos')!='top')?'right':'left'):'center',null,this.Get('chart.labels.above.angle'));}}else if(variant=='dot'){this.context.beginPath();this.context.moveTo(x+(width/2),y);this.context.lineTo(x+(width/2),y+height);this.context.stroke();this.context.beginPath();this.context.fillStyle=this.Get('chart.colors')[i];this.context.arc(x+(width/2),y+(this.data[i]>0?0:height),2,0,6.28,0);this.context.fillStyle=this.Get('chart.colors')[0];if(this.Get('chart.colors.sequential')){this.context.fillStyle=colors[i];}
this.context.stroke();this.context.fill();}else if(variant=='pyramid'){this.context.beginPath();var startY=(this.Get('chart.xaxispos')=='center'?(this.canvas.height/2):(this.canvas.height-this.gutterBottom));this.context.moveTo(x+hmargin,startY);this.context.lineTo(x+hmargin+(barWidth/2),y+(this.Get('chart.xaxispos')=='center'&&(this.data[i]<0)?height:0));this.context.lineTo(x+hmargin+barWidth,startY);this.context.closePath();this.context.stroke();this.context.fill();}else if(variant=='arrow'){var startY=(this.Get('chart.xaxispos')=='center'?(this.canvas.height/2):(this.canvas.height-this.gutterBottom));this.context.lineWidth=this.Get('chart.linewidth')?this.Get('chart.linewidth'):1;this.context.lineCap='round';this.context.beginPath();this.context.moveTo(AA(this,x+hmargin+(barWidth/2)),startY);this.context.lineTo(AA(this,x+hmargin+(barWidth/2)),y+(this.Get('chart.xaxispos')=='center'&&(this.data[i]<0)?height:0));this.context.arc(x+hmargin+(barWidth/2),y+(this.Get('chart.xaxispos')=='center'&&(this.data[i]<0)?height:0),5,this.data[i]>0?0.78:5.6,this.data[i]>0?0.79:5.48,this.data[i]<0);this.context.moveTo(AA(this,x+hmargin+(barWidth/2)),y+(this.Get('chart.xaxispos')=='center'&&(this.data[i]<0)?height:0));this.context.arc(x+hmargin+(barWidth/2),y+(this.Get('chart.xaxispos')=='center'&&(this.data[i]<0)?height:0),5,this.data[i]>0?2.355:4,this.data[i]>0?2.4:3.925,this.data[i]<0);this.context.stroke();this.context.lineWidth=1;}else{alert('[BAR] Warning! Unknown chart.variant: '+variant);}
this.coords.push([x+hmargin,y,width-(2*hmargin),height]);}else if(typeof(this.data[i])=='object'&&this.Get('chart.grouping')=='stacked'){if(this.min){alert("[ERROR] Stacked Bar charts with a Y min are not supported");}
var barWidth=width-(2*hmargin);var redrawCoords=[];var startY=0;var dataset=this.data[i];if(barWidth<0){alert('[RGRAPH] Warning: you have a negative bar width. This may be caused by the chart.hmargin being too high or the width of the canvas not being sufficient.');}
for(j=0;j<dataset.length;++j){if(xaxispos=='center'){alert("[BAR] It's pointless having the X axis position at the center on a stacked bar chart.");return;}
if(this.data[i][j]<0){alert('[BAR] Negative values are not permitted with a stacked bar chart. Try a grouped one instead.');return;}
this.context.strokeStyle=strokeStyle
this.context.fillStyle=colors[j];if(this.Get('chart.colors.reverse')){this.context.fillStyle=colors[this.data[i].length-j-1];}
if(this.Get('chart.colors.sequential')&&colors[sequentialColorIndex]){this.context.fillStyle=colors[sequentialColorIndex++];}else if(this.Get('chart.colors.sequential')){this.context.fillStyle=colors[sequentialColorIndex-1];}
var height=(dataset[j]/this.max)*(this.canvas.height-this.gutterTop-this.gutterBottom);if(xaxispos=='center'){height/=2;}
var totalHeight=(RGraph.array_sum(dataset)/this.max)*(this.canvas.height-hmargin-this.gutterTop-this.gutterBottom);this.coords.push([x+hmargin,y,width-(2*hmargin),height]);if(RGraph.isOld()&&shadow){this.DrawIEShadow([x+hmargin,y,width-(2*hmargin),height+1]);}
this.context.strokeRect(x+hmargin,y,width-(2*hmargin),height);this.context.fillRect(x+hmargin,y,width-(2*hmargin),height);if(j==0){var startY=y;var startX=x;}
if(shadow){redrawCoords.push([x+hmargin,y,width-(2*hmargin),height,this.context.fillStyle]);}
if(variant=='3d'){var prevFillStyle=this.context.fillStyle;var prevStrokeStyle=this.context.strokeStyle;if(j==0){this.context.beginPath();this.context.moveTo(startX+hmargin,y);this.context.lineTo(startX+10+hmargin,y-5);this.context.lineTo(startX+10+barWidth+hmargin,y-5);this.context.lineTo(startX+barWidth+hmargin,y);this.context.closePath();this.context.fill();this.context.stroke();}
this.context.beginPath();this.context.moveTo(startX+barWidth+hmargin,y);this.context.lineTo(startX+barWidth+hmargin+10,y-5);this.context.lineTo(startX+barWidth+hmargin+10,y-5+height);this.context.lineTo(startX+barWidth+hmargin,y+height);this.context.closePath();this.context.fill();this.context.stroke();if(j==0){this.context.fillStyle='rgba(255,255,255,0.3)';this.context.beginPath();this.context.moveTo(startX+hmargin,y);this.context.lineTo(startX+10+hmargin,y-5);this.context.lineTo(startX+10+barWidth+hmargin,y-5);this.context.lineTo(startX+barWidth+hmargin,y);this.context.closePath();this.context.fill();this.context.stroke();}
this.context.fillStyle='rgba(0,0,0,0.4)';this.context.beginPath();this.context.moveTo(startX+barWidth+hmargin,y);this.context.lineTo(startX+barWidth+hmargin+10,y-5);this.context.lineTo(startX+barWidth+hmargin+10,y-5+height);this.context.lineTo(startX+barWidth+hmargin,y+height);this.context.closePath();this.context.fill();this.context.stroke();this.context.strokeStyle=prevStrokeStyle;this.context.fillStyle=prevFillStyle;}
y+=height;}
if(this.Get('chart.labels.above')){RGraph.NoShadow(this);this.context.fillStyle=this.Get('chart.text.color');RGraph.Text(this.context,this.Get('chart.text.font'),typeof(this.Get('chart.labels.above.size'))=='number'?this.Get('chart.labels.above.size'):this.Get('chart.text.size')-3,startX+(barWidth/2)+this.Get('chart.hmargin'),startY-(this.Get('chart.shadow')&&this.Get('chart.shadow.offsety')<0?7:4)-(this.Get('chart.variant')=='3d'?5:0),String(this.Get('chart.units.pre')+RGraph.array_sum(this.data[i]).toFixed(this.Get('chart.labels.above.decimals'))+this.Get('chart.units.post')),this.Get('chart.labels.above.angle')?'bottom':null,this.Get('chart.labels.above.angle')?(this.Get('chart.labels.above.angle')>0?'right':'left'):'center',null,this.Get('chart.labels.above.angle'));if(shadow){this.context.shadowColor=shadowColor;this.context.shadowBlur=shadowBlur;this.context.shadowOffsetX=shadowOffsetX;this.context.shadowOffsetY=shadowOffsetY;}}
if(shadow){RGraph.NoShadow(this);for(k=0;k<redrawCoords.length;++k){this.context.strokeStyle=strokeStyle;this.context.fillStyle=redrawCoords[k][4];this.context.strokeRect(redrawCoords[k][0],redrawCoords[k][1],redrawCoords[k][2],redrawCoords[k][3]);this.context.fillRect(redrawCoords[k][0],redrawCoords[k][1],redrawCoords[k][2],redrawCoords[k][3]);this.context.stroke();this.context.fill();}
redrawCoords=[];}}else if(typeof(this.data[i])=='object'&&this.Get('chart.grouping')=='grouped'){var redrawCoords=[];this.context.lineWidth=this.Get('chart.linewidth');for(j=0;j<this.data[i].length;++j){this.context.strokeStyle=strokeStyle;this.context.fillStyle=colors[j];if(this.Get('chart.colors.sequential')&&colors[sequentialColorIndex]){this.context.fillStyle=colors[sequentialColorIndex++];}else if(this.Get('chart.colors.sequential')){this.context.fillStyle=colors[sequentialColorIndex-1];}
var individualBarWidth=(width-(2*hmargin))/this.data[i].length;var height=((this.data[i][j]+(this.data[i][j]<0?this.min:(-1*this.min)))/(this.max-this.min))*(this.canvas.height-this.gutterTop-this.gutterBottom);if(individualBarWidth<0){alert('[RGRAPH] Warning: you have a negative bar width. This may be caused by the chart.hmargin being too high or the width of the canvas not being sufficient.');}
if(xaxispos=='center'){height/=2;}
var startX=x+hmargin+(j*individualBarWidth);if(xaxispos=='top'){var startY=this.Get('chart.gutter.top');var height=Math.abs(height);}else if(xaxispos=='center'){var startY=this.gutterTop+(this.grapharea/2)-height;}else{var startY=this.canvas.height-this.gutterBottom-height;var height=Math.abs(height);}
if(RGraph.isOld()&&shadow){this.DrawIEShadow([startX,startY,individualBarWidth,height]);}
var groupedMargin=this.Get('chart.hmargin.grouped');this.context.strokeRect(startX+groupedMargin,startY,individualBarWidth-(2*groupedMargin),height);this.context.fillRect(startX+groupedMargin,startY,individualBarWidth-(2*groupedMargin),height);y+=height;if(variant=='3d'){var prevFillStyle=this.context.fillStyle;var prevStrokeStyle=this.context.strokeStyle;this.context.beginPath();this.context.moveTo(startX,startY);this.context.lineTo(startX+10,startY-5);this.context.lineTo(startX+10+individualBarWidth,startY-5);this.context.lineTo(startX+individualBarWidth,startY);this.context.closePath();this.context.fill();this.context.stroke();this.context.beginPath();this.context.moveTo(startX+individualBarWidth,startY);this.context.lineTo(startX+individualBarWidth+10,startY-5);this.context.lineTo(startX+individualBarWidth+10,startY-5+height);this.context.lineTo(startX+individualBarWidth,startY+height);this.context.closePath();this.context.fill();this.context.stroke();this.context.fillStyle='rgba(255,255,255,0.3)';this.context.beginPath();this.context.moveTo(startX,startY);this.context.lineTo(startX+10,startY-5);this.context.lineTo(startX+10+individualBarWidth,startY-5);this.context.lineTo(startX+individualBarWidth,startY);this.context.closePath();this.context.fill();this.context.stroke();this.context.fillStyle='rgba(0,0,0,0.4)';this.context.beginPath();this.context.moveTo(startX+individualBarWidth,startY);this.context.lineTo(startX+individualBarWidth+10,startY-5);this.context.lineTo(startX+individualBarWidth+10,startY-5+height);this.context.lineTo(startX+individualBarWidth,startY+height);this.context.closePath();this.context.fill();this.context.stroke();this.context.strokeStyle=prevStrokeStyle;this.context.fillStyle=prevFillStyle;}
if(height<0){height=Math.abs(height);startY=startY-height;}
this.coords.push([startX,startY,individualBarWidth,height]);if(this.Get('chart.shadow')){redrawCoords.push([startX+groupedMargin,startY,individualBarWidth-(2*groupedMargin),height,this.context.fillStyle]);}
if(this.Get('chart.labels.above')){this.context.strokeStyle='rgba(0,0,0,0)';if(shadow){RGraph.NoShadow(this);}
var yPos=y-3;if(this.data[i][j]<0){yPos+=height+6+(this.Get('chart.text.size')-4);}
this.context.fillStyle=this.Get('chart.text.color');RGraph.Text(this.context,this.Get('chart.text.font'),typeof(this.Get('chart.labels.above.size'))=='number'?this.Get('chart.labels.above.size'):this.Get('chart.text.size')-3,startX+(individualBarWidth/2),startY-2-(this.Get('chart.variant')=='3d'?5:0),RGraph.number_format(this,this.data[i][j].toFixed(this.Get('chart.labels.above.decimals'))),null,this.Get('chart.labels.above.angle')?(this.Get('chart.labels.above.angle')>0?'right':'left'):'center',null,this.Get('chart.labels.above.angle'));if(shadow){this.context.shadowColor=shadowColor;this.context.shadowBlur=shadowBlur;this.context.shadowOffsetX=shadowOffsetX;this.context.shadowOffsetY=shadowOffsetY;}}}
if(redrawCoords.length){RGraph.NoShadow(this);this.context.lineWidth=this.Get('chart.linewidth');this.context.beginPath();for(var j=0;j<redrawCoords.length;++j){this.context.fillStyle=redrawCoords[j][4];this.context.strokeStyle=this.Get('chart.strokecolor');this.context.fillRect(redrawCoords[j][0],redrawCoords[j][1],redrawCoords[j][2],redrawCoords[j][3]);this.context.strokeRect(redrawCoords[j][0],redrawCoords[j][1],redrawCoords[j][2],redrawCoords[j][3]);}
this.context.fill();this.context.stroke();redrawCoords=[];}}
this.context.closePath();}
RGraph.NoShadow(this);}
RGraph.Bar.prototype.DrawLabels=function()
{var context=this.context;var text_angle=this.Get('chart.text.angle');var text_size=this.Get('chart.text.size');var labels=this.Get('chart.labels');if(this.Get('chart.ylabels')){this.Drawlabels_top();this.Drawlabels_center();this.Drawlabels_bottom();}
if(typeof(labels)=='object'&&labels){var yOffset=13+Number(this.Get('chart.xlabels.offset'));var angle=0;var halign='center';if(text_angle>0){angle=-1*text_angle;halign='right';yOffset-=5;if(this.Get('chart.xaxispos')=='top'){halign='left';yOffset+=5;}}
context.fillStyle=this.Get('chart.text.color');var barWidth=(this.canvas.width-this.gutterRight-this.gutterLeft)/labels.length;xTickGap=(this.canvas.width-this.gutterRight-this.gutterLeft)/labels.length
var i=0;var font=this.Get('chart.text.font');for(x=this.gutterLeft+(xTickGap/2);x<=this.canvas.width-this.gutterRight;x+=xTickGap){RGraph.Text(context,font,text_size,x+(this.Get('chart.text.angle')==90?0:0),this.Get('chart.xaxispos')=='top'?this.gutterTop-yOffset+text_size-1:(this.canvas.height-this.gutterBottom)+yOffset,String(labels[i++]),(this.Get('chart.text.angle')==90?'center':null),halign,null,angle);}}}
RGraph.Bar.prototype.Drawlabels_top=function()
{this.context.beginPath();this.context.fillStyle=this.Get('chart.text.color');this.context.strokeStyle='black';if(this.Get('chart.xaxispos')=='top'){var context=this.context;var interval=(this.grapharea*(1/5));var text_size=this.Get('chart.text.size');var units_pre=this.Get('chart.units.pre');var units_post=this.Get('chart.units.post');var align=this.Get('chart.yaxispos')=='left'?'right':'left';var font=this.Get('chart.text.font');var numYLabels=this.Get('chart.ylabels.count');if(this.Get('chart.ylabels.inside')==true){var xpos=this.Get('chart.yaxispos')=='left'?this.gutterLeft+5:this.canvas.width-this.gutterRight-5;var align=this.Get('chart.yaxispos')=='left'?'left':'right';var boxed=true;}else{var xpos=this.Get('chart.yaxispos')=='left'?this.gutterLeft-5:this.canvas.width-this.gutterRight+5;var boxed=false;}
if(typeof(this.Get('chart.ylabels.specific'))=='object'&&this.Get('chart.ylabels.specific')){var labels=RGraph.array_reverse(this.Get('chart.ylabels.specific'));var grapharea=this.canvas.height-this.gutterTop-this.gutterBottom;for(var i=0;i<labels.length;++i){var y=this.gutterTop+(grapharea*(i/labels.length))+(grapharea/labels.length);RGraph.Text(context,font,text_size,xpos,y,labels[i],'center',align,boxed);}
return;}
if(numYLabels==1){RGraph.Text(context,font,text_size,xpos,this.canvas.height-this.gutterBottom,'-'+RGraph.number_format(this,Number(this.scale[4]).toFixed((this.Get('chart.scale.decimals'))),units_pre,units_post),'center',align,boxed);}
if(numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,this.gutterTop+this.halfTextHeight+interval,'-'+RGraph.number_format(this,this.scale[0],units_pre,units_post),null,align,boxed);if(numYLabels==5){RGraph.Text(context,font,text_size,xpos,(1*interval)+this.gutterTop+this.halfTextHeight+interval,'-'+RGraph.number_format(this,this.scale[1],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(3*interval)+this.gutterTop+this.halfTextHeight+interval,'-'+RGraph.number_format(this,this.scale[3],units_pre,units_post),null,align,boxed);}
if(numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,(2*interval)+this.gutterTop+this.halfTextHeight+interval,'-'+RGraph.number_format(this,this.scale[2],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(4*interval)+this.gutterTop+this.halfTextHeight+interval,'-'+RGraph.number_format(this,this.scale[4],units_pre,units_post),null,align,boxed);}}
if(numYLabels==10){interval=(this.grapharea/numYLabels);for(var i=10;i>0;--i){RGraph.Text(context,font,text_size,xpos,this.gutterTop+((this.grapharea/numYLabels)*i),'-'+RGraph.number_format(this,((this.scale[4]/numYLabels)*i).toFixed((this.Get('chart.scale.decimals'))),units_pre,units_post),'center',align,boxed);}}
if(this.Get('chart.ymin')!=0){RGraph.Text(context,font,text_size,xpos,this.gutterTop,'-'+RGraph.number_format(this,(this.min.toFixed((this.Get('chart.scale.decimals')))),units_pre,units_post),'center',align,boxed);}}
this.context.fill();this.context.stroke();}
RGraph.Bar.prototype.Drawlabels_center=function()
{var font=this.Get('chart.text.font');var numYLabels=this.Get('chart.ylabels.count');this.context.fillStyle=this.Get('chart.text.color');if(this.Get('chart.xaxispos')=='center'){var interval=(this.grapharea*(1/10));var text_size=this.Get('chart.text.size');var units_pre=this.Get('chart.units.pre');var units_post=this.Get('chart.units.post');var context=this.context;var align='';var xpos=0;var boxed=false;this.context.fillStyle=this.Get('chart.text.color');this.context.strokeStyle='black';if(this.Get('chart.ylabels.inside')==true){var xpos=this.Get('chart.yaxispos')=='left'?this.gutterLeft+5:this.canvas.width-this.gutterRight-5;var align=this.Get('chart.yaxispos')=='left'?'left':'right';var boxed=true;}else{var xpos=this.Get('chart.yaxispos')=='left'?this.gutterLeft-5:this.canvas.width-this.gutterRight+5;var align=this.Get('chart.yaxispos')=='left'?'right':'left';var boxed=false;}
if(typeof(this.Get('chart.ylabels.specific'))=='object'&&this.Get('chart.ylabels.specific')){var labels=this.Get('chart.ylabels.specific');var grapharea=this.canvas.height-this.gutterTop-this.gutterBottom;for(var i=0;i<labels.length;++i){var y=this.gutterTop+((grapharea/2)/labels.length)*i;RGraph.Text(context,font,text_size,xpos,y,String(labels[i]),'center',align,boxed);}
for(var i=labels.length-1;i>=0;--i){var y=this.gutterTop+(grapharea*((i+1)/(labels.length*2)))+(grapharea/2);RGraph.Text(context,font,text_size,xpos,y,labels[labels.length-i-1],'center',align,boxed);}
return;}
if(numYLabels==1||numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[4],units_pre,units_post),null,align,boxed);if(numYLabels==5){RGraph.Text(context,font,text_size,xpos,(1*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[3],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(3*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[1],units_pre,units_post),null,align,boxed);}
if(numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,(4*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[0],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(2*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[2],units_pre,units_post),null,align,boxed);}}else if(numYLabels==10){interval=(this.grapharea/numYLabels)/2;for(var i=0;i<numYLabels;++i){RGraph.Text(context,font,text_size,xpos,this.gutterTop+((this.grapharea/(numYLabels*2))*i),RGraph.number_format(this,((this.scale[4]/numYLabels)*(numYLabels-i)).toFixed((this.Get('chart.scale.decimals'))),units_pre,units_post),'center',align,boxed);}}
var interval=(this.grapharea)/10;if(numYLabels==1||numYLabels==3||numYLabels==5){if(numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,(this.grapharea+this.gutterTop+this.halfTextHeight)-(4*interval),'-'+RGraph.number_format(this,this.scale[0],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(this.grapharea+this.gutterTop+this.halfTextHeight)-(2*interval),'-'+RGraph.number_format(this,this.scale[2],units_pre,units_post),null,align,boxed);}
if(numYLabels==5){RGraph.Text(context,font,text_size,xpos,(this.grapharea+this.gutterTop+this.halfTextHeight)-(3*interval),'-'+RGraph.number_format(this,this.scale[1],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(this.grapharea+this.gutterTop+this.halfTextHeight)-interval,'-'+RGraph.number_format(this,this.scale[3],units_pre,units_post),null,align,boxed);}
RGraph.Text(context,font,text_size,xpos,this.grapharea+this.gutterTop+this.halfTextHeight,'-'+RGraph.number_format(this,this.scale[4],units_pre,units_post),null,align,boxed);}else if(numYLabels==10){interval=(this.grapharea/numYLabels)/2;for(var i=0;i<numYLabels;++i){RGraph.Text(context,font,text_size,xpos,this.gutterTop+(this.grapharea/2)+((this.grapharea/(numYLabels*2))*i)+(this.grapharea/(numYLabels*2)),RGraph.number_format(this,((this.scale[4]/numYLabels)*(i+1)).toFixed((this.Get('chart.scale.decimals'))),'-'+units_pre,units_post),'center',align,boxed);}}
if(this.Get('chart.ymin')!=0){RGraph.Text(context,font,text_size,xpos,this.gutterTop+(this.grapharea/2),RGraph.number_format(this,(this.min.toFixed((this.Get('chart.scale.decimals')))),units_pre,units_post),'center',align,boxed);}}}
RGraph.Bar.prototype.Drawlabels_bottom=function()
{this.context.beginPath();this.context.fillStyle=this.Get('chart.text.color');this.context.strokeStyle='black';if(this.Get('chart.xaxispos')!='center'&&this.Get('chart.xaxispos')!='top'){var interval=(this.grapharea*(1/5));var text_size=this.Get('chart.text.size');var units_pre=this.Get('chart.units.pre');var units_post=this.Get('chart.units.post');var context=this.context;var align=this.Get('chart.yaxispos')=='left'?'right':'left';var font=this.Get('chart.text.font');var numYLabels=this.Get('chart.ylabels.count');if(this.Get('chart.ylabels.inside')==true){var xpos=this.Get('chart.yaxispos')=='left'?this.gutterLeft+5:this.canvas.width-this.gutterRight-5;var align=this.Get('chart.yaxispos')=='left'?'left':'right';var boxed=true;}else{var xpos=this.Get('chart.yaxispos')=='left'?this.gutterLeft-5:this.canvas.width-this.gutterRight+5;var boxed=false;}
if(this.Get('chart.ylabels.specific')&&typeof(this.Get('chart.ylabels.specific'))=='object'){var labels=this.Get('chart.ylabels.specific');var grapharea=this.canvas.height-this.gutterTop-this.gutterBottom;for(var i=0;i<labels.length;++i){var y=this.gutterTop+(grapharea*(i/labels.length));RGraph.Text(context,font,text_size,xpos,y,labels[i],'center',align,boxed);}
return;}
if(numYLabels==1||numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[4],units_pre,units_post),null,align,boxed);if(numYLabels==5){RGraph.Text(context,font,text_size,xpos,(1*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[3],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(3*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[1],units_pre,units_post),null,align,boxed);}
if(numYLabels==3||numYLabels==5){RGraph.Text(context,font,text_size,xpos,(2*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[2],units_pre,units_post),null,align,boxed);RGraph.Text(context,font,text_size,xpos,(4*interval)+this.gutterTop+this.halfTextHeight,RGraph.number_format(this,this.scale[0],units_pre,units_post),null,align,boxed);}}
if(numYLabels==10){interval=(this.grapharea/numYLabels);for(var i=0;i<numYLabels;++i){RGraph.Text(context,font,text_size,xpos,this.gutterTop+((this.grapharea/numYLabels)*i),RGraph.number_format(this,((this.scale[4]/numYLabels)*(numYLabels-i)).toFixed((this.Get('chart.scale.decimals'))),units_pre,units_post),'center',align,boxed);}}
if(this.Get('chart.ymin')!=0){RGraph.Text(context,font,text_size,xpos,this.canvas.height-this.gutterBottom,RGraph.number_format(this,(this.min.toFixed((this.Get('chart.scale.decimals')))),units_pre,units_post),'center',align,boxed);}}
this.context.fill();this.context.stroke();}
RGraph.Bar.prototype.DrawIEShadow=function(coords)
{var prevFillStyle=this.context.fillStyle;var offsetx=this.Get('chart.shadow.offsetx');var offsety=this.Get('chart.shadow.offsety');this.context.lineWidth=this.Get('chart.linewidth');this.context.fillStyle=this.Get('chart.shadow.color');this.context.beginPath();this.context.fillRect(coords[0]+offsetx,coords[1]+offsety,coords[2],coords[3]);this.context.fill();this.context.fillStyle=prevFillStyle;}
RGraph.Bar.prototype.getShape=RGraph.Bar.prototype.getBar=function(e)
{var obj=arguments[1]?arguments[1]:this;var mouseXY=RGraph.getMouseXY(e);var mouseX=mouseXY[0];var mouseY=mouseXY[1];for(var i=0;i<this.coords.length;i++){var left=obj.coords[i][0];var top=obj.coords[i][1];var width=obj.coords[i][2];var height=obj.coords[i][3];if(mouseX>=left&&mouseX<=(left+width)&&mouseY>=top&&mouseY<=(top+height)){if(this.Get('chart.tooltips')){var tooltip=RGraph.parseTooltipText?RGraph.parseTooltipText(this.Get('chart.tooltips'),i):this.Get('chart.tooltips')[i];}
var dataset=0;var idx=i;while(idx>=(typeof(this.data[dataset])=='object'?this.data[dataset].length:1)){if(typeof(this.data[dataset])=='number'){idx-=1;}else{idx-=this.data[dataset].length;}
dataset++;}
if(typeof(this.data[dataset])=='number'){idx=null;}
return{0:obj,1:left,2:top,3:width,4:height,5:i,'object':obj,'x':left,'y':top,'width':width,'height':height,'index':i,'tooltip':tooltip,'index_adjusted':idx,'dataset':dataset};}}
return null;}
RGraph.Bar.prototype.getShapeByX=function(e)
{var canvas=e.target;var mouseCoords=RGraph.getMouseXY(e);var obj=arguments[1]?arguments[1]:this;for(var i=0;i<obj.coords.length;i++){var mouseX=mouseCoords[0];var mouseY=mouseCoords[1];var left=obj.coords[i][0];var top=obj.coords[i][1];var width=obj.coords[i][2];var height=obj.coords[i][3];if(mouseX>=left&&mouseX<=(left+width)){if(this.Get('chart.tooltips')){var tooltip=RGraph.parseTooltipText?RGraph.parseTooltipText(this.Get('chart.tooltips'),i):this.Get('chart.tooltips')[i];}
return{0:obj,1:left,2:top,3:width,4:height,5:i,'object':obj,'x':left,'y':top,'width':width,'height':height,'index':i,'tooltip':tooltip};}}
return null;}
RGraph.Bar.prototype.getValue=function(arg)
{if(arg.length==2){var mouseX=arg[0];var mouseY=arg[1];}else{var mouseCoords=RGraph.getMouseXY(arg);var mouseX=mouseCoords[0];var mouseY=mouseCoords[1];}
if(mouseY<this.Get('chart.gutter.top')||mouseY>(this.canvas.height-this.Get('chart.gutter.bottom'))||mouseX<this.Get('chart.gutter.left')||mouseX>(this.canvas.width-this.Get('chart.gutter.right'))){return null;}
if(this.Get('chart.xaxispos')=='center'){var value=(((this.grapharea/2)-(mouseY-this.Get('chart.gutter.top')))/this.grapharea)*(this.max-this.min)
value*=2;if(value>=0){value+=this.min;}else{value-=this.min;}}else if(this.Get('chart.xaxispos')=='top'){var value=((this.grapharea-(mouseY-this.Get('chart.gutter.top')))/this.grapharea)*(this.max-this.min)
value=this.max-value;value=Math.abs(value)*-1;}else{var value=((this.grapharea-(mouseY-this.Get('chart.gutter.top')))/this.grapharea)*(this.max-this.min)
value+=this.min;}
return value;}
RGraph.Bar.prototype.getYCoord=function(value)
{if(typeof(value)!='number'){return null;}
var y;var xaxispos=this.Get('chart.xaxispos');if(value>this.max){value=this.max;}
if(xaxispos=='top'){if(value<0){value=Math.abs(value);}
y=((value-this.min)/(this.max-this.min))*this.grapharea;y=y+this.gutterTop}else if(xaxispos=='center'){y=((value-this.min)/(this.max-this.min))*(this.grapharea/2);y=(this.grapharea/2)-y;y+=this.gutterTop;}else{if(value<this.min){value=this.min;}
y=((value-this.min)/(this.max-this.min))*this.grapharea;y=this.canvas.height-this.gutterBottom-y;}
return y;}
RGraph.Bar.prototype.Highlight=function(shape)
{RGraph.Highlight.Rect(this,shape);}
RGraph.Bar.prototype.getObjectByXY=function(e)
{var mouseXY=RGraph.getMouseXY(e);if(mouseXY[0]>=this.Get('chart.gutter.left')&&mouseXY[0]<=(this.canvas.width-this.Get('chart.gutter.right'))&&mouseXY[1]>=this.Get('chart.gutter.top')&&mouseXY[1]<=(this.canvas.height-this.Get('chart.gutter.bottom'))){return this;}}
RGraph.Bar.prototype.Adjusting_mousemove=function(e)
{if(RGraph.Registry.Get('chart.adjusting')&&RGraph.Registry.Get('chart.adjusting').uid==this.uid){var value=Number(this.getValue(e));var shape=this.getShapeByX(e);if(shape){RGraph.Registry.Set('chart.adjusting.shape',shape);this.data[shape['index']]=Number(value);RGraph.RedrawCanvas(e.target);RGraph.FireCustomEvent(this,'onadjust');}}}
RGraph.CombinedChart=function()
{this.objects=[];for(var i=0;i<arguments.length;++i){this.objects[i]=arguments[i];this.objects[i].Set('chart.gutter.left',this.objects[0].Get('chart.gutter.left'));this.objects[i].Set('chart.gutter.right',this.objects[0].Get('chart.gutter.right'));this.objects[i].Set('chart.gutter.top',this.objects[0].Get('chart.gutter.top'));this.objects[i].Set('chart.gutter.bottom',this.objects[0].Get('chart.gutter.bottom'));if(this.objects[i].type=='line'){this.objects[i].Set('chart.hmargin',((this.objects[0].canvas.width-this.objects[0].Get('chart.gutter.right')-this.objects[0].Get('chart.gutter.left'))/this.objects[0].data.length)/2);this.objects[i].Set('chart.noaxes',true);this.objects[i].Set('chart.background.grid',false);this.objects[i].Set('chart.ylabels',false);}
if(this.objects[i].Get('chart.resizable')){var resizable=true;}}
if(resizable){function myOnresizebeforedraw(obj)
{var gutterLeft=obj.Get('chart.gutter.left');var gutterRight=obj.Get('chart.gutter.right');obj.Set('chart.hmargin',(obj.canvas.width-gutterLeft-gutterRight)/(obj.original_data[0].length*2));}
RGraph.AddCustomEventListener(RGraph.ObjectRegistry.getFirstObjectByType(this.objects[0].canvas.id,'line'),'onresizebeforedraw',myOnresizebeforedraw);}}
RGraph.CombinedChart.prototype.Draw=function()
{for(var i=0;i<this.objects.length;++i){if(typeof(arguments[i])=='function'){arguments[i](this.objects[i]);}else{this.objects[i].Draw();}}}
RGraph.Bar.prototype.positionTooltip=function(obj,x,y,tooltip,idx)
{var coordX=obj.coords[tooltip.__index__][0];var coordY=obj.coords[tooltip.__index__][1];var coordW=obj.coords[tooltip.__index__][2];var coordH=obj.coords[tooltip.__index__][3];var canvasXY=RGraph.getCanvasXY(obj.canvas);var gutterLeft=obj.Get('chart.gutter.left');var gutterTop=obj.Get('chart.gutter.top');var width=tooltip.offsetWidth;var height=tooltip.offsetHeight;tooltip.style.left=0;tooltip.style.top=canvasXY[1]+coordY+(coordH/2)-height-7+'px';tooltip.style.overflow='';var img=new Image();img.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAFCAYAAACjKgd3AAAARUlEQVQYV2NkQAN79+797+RkhC4M5+/bd47B2dmZEVkBCgcmgcsgbAaA9GA1BCSBbhAuA/AagmwQPgMIGgIzCD0M0AMMAEFVIAa6UQgcAAAAAElFTkSuQmCC';img.style.position='absolute';img.id='__rgraph_tooltip_pointer__';img.style.top=(tooltip.offsetHeight-2)+'px';tooltip.appendChild(img);if((canvasXY[0]+coordX+(coordW/2)-(width/2))<10){tooltip.style.left=(canvasXY[0]+coordX-(width*0.1))+(coordW/2)+'px';img.style.left=((width*0.1)-8.5)+'px';}else if((canvasXY[0]+coordX+(width/2))>document.body.offsetWidth){tooltip.style.left=canvasXY[0]+coordX-(width*0.9)+(coordW/2)+'px';img.style.left=((width*0.9)-8.5)+'px';}else{tooltip.style.left=(canvasXY[0]+coordX+(coordW/2)-(width*0.5))+'px';img.style.left=((width*0.5)-8.5)+'px';}}
if(typeof(RGraph)=='undefined')RGraph={};RGraph.HBar=function(id,data)
{this.id=id;this.canvas=document.getElementById(id);this.context=this.canvas.getContext?this.canvas.getContext("2d"):null;this.canvas.__object__=this;this.data=data;this.type='hbar';this.coords=[];this.isRGraph=true;this.uid=RGraph.CreateUID();this.canvas.uid=this.canvas.uid?this.canvas.uid:RGraph.CreateUID();RGraph.OldBrowserCompat(this.context);this.max=0;this.stackedOrGrouped=false;this.properties={'chart.gutter.left':75,'chart.gutter.right':25,'chart.gutter.top':35,'chart.gutter.bottom':25,'chart.background.grid':true,'chart.background.grid.color':'#ddd','chart.background.grid.width':1,'chart.background.grid.hsize':25,'chart.background.grid.vsize':25,'chart.background.barcolor1':'rgba(0,0,0,0)','chart.background.barcolor2':'rgba(0,0,0,0)','chart.background.grid.hlines':true,'chart.background.grid.vlines':true,'chart.background.grid.border':true,'chart.background.grid.autofit':true,'chart.background.grid.autofit.numhlines':14,'chart.background.grid.autofit.numvlines':20,'chart.title':'','chart.title.background':null,'chart.title.xaxis':'','chart.title.xaxis.bold':true,'chart.title.xaxis.size':null,'chart.title.xaxis.font':null,'chart.title.yaxis':'','chart.title.yaxis.bold':true,'chart.title.yaxis.size':null,'chart.title.yaxis.font':null,'chart.title.xaxis.pos':null,'chart.title.yaxis.pos':10,'chart.title.hpos':null,'chart.title.vpos':null,'chart.title.bold':true,'chart.title.font':null,'chart.text.size':10,'chart.text.color':'black','chart.text.font':'Arial','chart.colors':['red','blue','green','pink','yellow','cyan','navy','gray','black'],'chart.colors.sequential':false,'chart.labels':[],'chart.labels.above':false,'chart.labels.above.decimals':0,'chart.xlabels':true,'chart.contextmenu':null,'chart.key':null,'chart.key.background':'white','chart.key.position':'graph','chart.key.halign':'right','chart.key.shadow':false,'chart.key.shadow.color':'#666','chart.key.shadow.blur':3,'chart.key.shadow.offsetx':2,'chart.key.shadow.offsety':2,'chart.key.position.gutter.boxed':true,'chart.key.position.x':null,'chart.key.position.y':null,'chart.key.color.shape':'square','chart.key.rounded':true,'chart.key.linewidth':1,'chart.key.colors':null,'chart.units.pre':'','chart.units.post':'','chart.units.ingraph':false,'chart.strokestyle':'rgba(0,0,0,0)','chart.xmin':0,'chart.xmax':0,'chart.axis.color':'black','chart.shadow':false,'chart.shadow.color':'#666','chart.shadow.blur':3,'chart.shadow.offsetx':3,'chart.shadow.offsety':3,'chart.vmargin':3,'chart.vmargin.grouped':1,'chart.grouping':'grouped','chart.tooltips':null,'chart.tooltips.event':'onclick','chart.tooltips.effect':'fade','chart.tooltips.css.class':'RGraph_tooltip','chart.tooltips.highlight':true,'chart.highlight.fill':'rgba(255,255,255,0.7)','chart.highlight.stroke':'rgba(0,0,0,0)','chart.annotatable':false,'chart.annotate.color':'black','chart.zoom.factor':1.5,'chart.zoom.fade.in':true,'chart.zoom.fade.out':true,'chart.zoom.hdir':'right','chart.zoom.vdir':'down','chart.zoom.frames':25,'chart.zoom.delay':16.666,'chart.zoom.shadow':true,'chart.zoom.background':true,'chart.zoom.action':'zoom','chart.resizable':false,'chart.resize.handle.adjust':[0,0],'chart.resize.handle.background':null,'chart.scale.point':'.','chart.scale.thousand':',','chart.scale.decimals':null,'chart.noredraw':false,'chart.events.click':null,'chart.events.mousemove':null,'chart.noxaxis':false,'chart.noyaxis':false,'chart.noxtickmarks':false,'chart.noytickmarks':false}
if(!this.canvas){alert('[HBAR] No canvas support');return;}
for(i=0;i<this.data.length;++i){if(typeof(this.data[i])=='object'){this.stackedOrGrouped=true;}}
this.data_arr=RGraph.array_linearize(this.data);RGraph.Register(this);}
RGraph.HBar.prototype.Set=function(name,value)
{if(name=='chart.labels.abovebar'){name='chart.labels.above';}
this.properties[name.toLowerCase()]=value;}
RGraph.HBar.prototype.Get=function(name)
{if(name=='chart.labels.abovebar'){name='chart.labels.above';}
return this.properties[name];}
RGraph.HBar.prototype.Draw=function()
{RGraph.FireCustomEvent(this,'onbeforedraw');this.gutterLeft=this.Get('chart.gutter.left');this.gutterRight=this.Get('chart.gutter.right');this.gutterTop=this.Get('chart.gutter.top');this.gutterBottom=this.Get('chart.gutter.bottom');this.coords=[];this.max=0;if(this.Get('chart.xmin')>0&&this.Get('chart.grouping')=='stacked'){alert('[HBAR] Using chart.xmin is not supported with stacked charts, resetting chart.xmin to zero');this.Set('chart.xmin',0);}
this.graphwidth=this.canvas.width-this.gutterLeft-this.gutterRight;this.graphheight=this.canvas.height-this.gutterTop-this.gutterBottom;this.halfgrapharea=this.grapharea/2;this.halfTextHeight=this.Get('chart.text.size')/2;RGraph.background.Draw(this);this.Drawbars();this.DrawAxes();this.DrawLabels();if(this.Get('chart.key')&&this.Get('chart.key').length){RGraph.DrawKey(this,this.Get('chart.key'),this.Get('chart.colors'));}
if(this.Get('chart.contextmenu')){RGraph.ShowContext(this);}
RGraph.DrawInGraphLabels(this);if(this.Get('chart.resizable')){RGraph.AllowResizing(this);}
RGraph.InstallEventListeners(this);RGraph.FireCustomEvent(this,'ondraw');}
RGraph.HBar.prototype.DrawAxes=function()
{var halfway=(this.graphwidth/2)+this.gutterLeft;this.context.beginPath();this.context.lineWidth=1;this.context.strokeStyle=this.Get('chart.axis.color');if(this.Get('chart.noyaxis')==false){if(this.Get('chart.yaxispos')=='center'){this.context.moveTo(AA(this,halfway),this.gutterTop);this.context.lineTo(AA(this,halfway),this.canvas.height-this.gutterBottom);}else{this.context.moveTo(AA(this,this.gutterLeft),this.gutterTop);this.context.lineTo(AA(this,this.gutterLeft),this.canvas.height-this.gutterBottom);}}
if(this.Get('chart.noxaxis')==false){this.context.moveTo(this.gutterLeft,AA(this,RGraph.GetHeight(this)-this.gutterBottom));this.context.lineTo(this.canvas.width-this.gutterRight,AA(this,this.canvas.height-this.gutterBottom));}
if(this.Get('chart.noytickmarks')==false&&this.Get('chart.noyaxis')==false){var yTickGap=(this.canvas.height-this.gutterTop-this.gutterBottom)/this.data.length;for(y=this.gutterTop;y<(this.canvas.height-this.gutterBottom-1);y+=yTickGap){if(this.Get('chart.yaxispos')=='center'){this.context.moveTo(halfway+3,AA(this,y));this.context.lineTo(halfway-3,AA(this,y));}else{this.context.moveTo(this.gutterLeft,AA(this,y));this.context.lineTo(this.gutterLeft-3,AA(this,y));}}
if(this.Get('chart.noxaxis')==true){if(this.Get('chart.yaxispos')=='center'){this.context.moveTo(halfway+3,AA(this,y));this.context.lineTo(halfway-3,AA(this,y));}else{this.context.moveTo(this.gutterLeft,AA(this,y));this.context.lineTo(this.gutterLeft-3,AA(this,y));}}}
if(this.Get('chart.noxtickmarks')==false&&this.Get('chart.noxaxis')==false){xTickGap=(this.canvas.width-this.gutterLeft-this.gutterRight)/10;yStart=this.canvas.height-this.gutterBottom;yEnd=(this.canvas.height-this.gutterBottom)+3;for(x=(this.canvas.width-this.gutterRight),i=0;this.Get('chart.yaxispos')=='center'?x>=this.gutterLeft:x>this.gutterLeft;x-=xTickGap){if(this.Get('chart.yaxispos')!='center'||i!=5){this.context.moveTo(AA(this,x),yStart);this.context.lineTo(AA(this,x),yEnd);}
i++;}}
this.context.stroke();}
RGraph.HBar.prototype.DrawLabels=function()
{var context=this.context;var canvas=this.canvas;var units_pre=this.Get('chart.units.pre');var units_post=this.Get('chart.units.post');var text_size=this.Get('chart.text.size');var font=this.Get('chart.text.font');if(this.Get('chart.units.ingraph')){units_pre='';units_post='';}
if(this.Get('chart.xlabels')){var gap=5;this.context.beginPath();this.context.fillStyle=this.Get('chart.text.color');if(this.Get('chart.yaxispos')=='center'){RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(10/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[4]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(9/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[3]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(8/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[2]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(7/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[1]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(6/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[0]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(4/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,'-'+RGraph.number_format(this,Number(this.scale[0]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(3/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,'-'+RGraph.number_format(this,Number(this.scale[1]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(2/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,'-'+RGraph.number_format(this,Number(this.scale[2]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(1/10)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,'-'+RGraph.number_format(this,Number(this.scale[3]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(0)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,'-'+RGraph.number_format(this,Number(this.scale[4]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');}else{RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(5/5)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[4]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(4/5)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[3]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(3/5)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[2]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(2/5)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[1]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');RGraph.Text(context,font,text_size,this.gutterLeft+(this.graphwidth*(1/5)),this.gutterTop+this.halfTextHeight+this.graphheight+gap,RGraph.number_format(this,Number(this.scale[0]).toFixed(this.Get('chart.scale.decimals')),units_pre,units_post),'center','center');if(this.Get('chart.xmin')>0){RGraph.Text(context,font,text_size,this.gutterLeft,this.gutterTop+this.halfTextHeight+this.graphheight+2,RGraph.number_format(this,this.Get('chart.xmin'),units_pre,units_post),'center','center');}}
this.context.fill();this.context.stroke();}
if(typeof(this.Get('chart.labels'))=='object'){var xOffset=5;var font=this.Get('chart.text.font');this.context.fillStyle=this.Get('chart.text.color');var barHeight=(RGraph.GetHeight(this)-this.gutterTop-this.gutterBottom)/this.Get('chart.labels').length;yTickGap=(RGraph.GetHeight(this)-this.gutterTop-this.gutterBottom)/this.Get('chart.labels').length
var i=0;for(y=this.gutterTop+(yTickGap/2);y<=RGraph.GetHeight(this)-this.gutterBottom;y+=yTickGap){RGraph.Text(this.context,font,this.Get('chart.text.size'),this.gutterLeft-xOffset,y,String(this.Get('chart.labels')[i++]),'center','right');}}}
RGraph.HBar.prototype.Drawbars=function()
{this.context.lineWidth=1;this.context.strokeStyle=this.Get('chart.strokestyle');this.context.fillStyle=this.Get('chart.colors')[0];var prevX=0;var prevY=0;if(this.Get('chart.xmax')){this.scale=[(((this.Get('chart.xmax')-this.Get('chart.xmin'))*0.2)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')),(((this.Get('chart.xmax')-this.Get('chart.xmin'))*0.4)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')),(((this.Get('chart.xmax')-this.Get('chart.xmin'))*0.6)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')),(((this.Get('chart.xmax')-this.Get('chart.xmin'))*0.8)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')),(((this.Get('chart.xmax')-this.Get('chart.xmin'))+this.Get('chart.xmin'))).toFixed(this.Get('chart.scale.decimals'))];this.max=this.scale[4];}else{var grouping=this.Get('chart.grouping');for(i=0;i<this.data.length;++i){if(typeof(this.data[i])=='object'){var value=grouping=='grouped'?Number(RGraph.array_max(this.data[i],true)):Number(RGraph.array_sum(this.data[i]));}else{var value=Number(Math.abs(this.data[i]));}
this.max=Math.max(Math.abs(this.max),Math.abs(value));}
this.scale=RGraph.getScale(this.max,this);if(this.Get('chart.xmin')>0){this.scale[0]=Number((((this.scale[4]-this.Get('chart.xmin'))*0.2)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')));this.scale[1]=Number((((this.scale[4]-this.Get('chart.xmin'))*0.4)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')));this.scale[2]=Number((((this.scale[4]-this.Get('chart.xmin'))*0.6)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')));this.scale[3]=Number((((this.scale[4]-this.Get('chart.xmin'))*0.8)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')));this.scale[4]=Number((((this.scale[4]-this.Get('chart.xmin'))*1.0)+this.Get('chart.xmin')).toFixed(this.Get('chart.scale.decimals')));}
this.max=this.scale[4];}
if(this.Get('chart.scale.decimals')==null&&Number(this.max)==1){this.Set('chart.scale.decimals',1);}
var colorIdx=0;var graphwidth=(this.canvas.width-this.gutterLeft-this.gutterRight);var halfwidth=graphwidth/2;for(i=0;i<this.data.length;++i){var width=(this.data[i]/this.max)*graphwidth;var height=this.graphheight/this.data.length;var orig_height=height;var x=this.gutterLeft;var y=this.gutterTop+(i*height);var vmargin=this.Get('chart.vmargin');if(width<0){x-=width;width=Math.abs(width);}
if(this.Get('chart.shadow')){this.context.shadowColor=this.Get('chart.shadow.color');this.context.shadowBlur=this.Get('chart.shadow.blur');this.context.shadowOffsetX=this.Get('chart.shadow.offsetx');this.context.shadowOffsetY=this.Get('chart.shadow.offsety');}
this.context.beginPath();if(typeof(this.data[i])=='number'){var barHeight=height-(2*vmargin);var barWidth=((this.data[i]-this.Get('chart.xmin'))/(this.max-this.Get('chart.xmin')))*this.graphwidth;var barX=this.gutterLeft;if(this.Get('chart.yaxispos')=='center'){barWidth/=2;barX+=halfwidth;if(this.data[i]<0){barWidth=(Math.abs(this.data[i])-this.Get('chart.xmin'))/(this.max-this.Get('chart.xmin'));barWidth=barWidth*(this.graphwidth/2);barX=((this.graphwidth/2)+this.gutterLeft)-barWidth;}}
this.context.strokeStyle=this.Get('chart.strokestyle');this.context.fillStyle=this.Get('chart.colors')[0];if(this.Get('chart.colors.sequential')){this.context.fillStyle=this.Get('chart.colors')[colorIdx++];}
this.context.strokeRect(barX,this.gutterTop+(i*height)+this.Get('chart.vmargin'),barWidth,barHeight);this.context.fillRect(barX,this.gutterTop+(i*height)+this.Get('chart.vmargin'),barWidth,barHeight);this.coords.push([barX,y+vmargin,barWidth,height-(2*vmargin),this.context.fillStyle,this.data[i],true]);}else if(typeof(this.data[i])=='object'&&this.Get('chart.grouping')=='stacked'){if(this.Get('chart.yaxispos')=='center'){alert('[HBAR] You can\'t have a stacked chart with the Y axis in the center, change it to grouped');}
var barHeight=height-(2*vmargin);for(j=0;j<this.data[i].length;++j){this.context.strokeStyle=this.Get('chart.strokestyle');this.context.fillStyle=this.Get('chart.colors')[j];if(this.Get('chart.colors.sequential')){this.context.fillStyle=this.Get('chart.colors')[colorIdx++];}
var width=(((this.data[i][j])/(this.max)))*this.graphwidth;var totalWidth=(RGraph.array_sum(this.data[i])/this.max)*this.graphwidth;this.context.strokeRect(x,this.gutterTop+this.Get('chart.vmargin')+(this.graphheight/this.data.length)*i,width,height-(2*vmargin));this.context.fillRect(x,this.gutterTop+this.Get('chart.vmargin')+(this.graphheight/this.data.length)*i,width,height-(2*vmargin));this.coords.push([x,y+vmargin,width,height-(2*vmargin),this.context.fillStyle,RGraph.array_sum(this.data[i]),j==(this.data[i].length-1)]);x+=width;}}else if(typeof(this.data[i])=='object'&&this.Get('chart.grouping')=='grouped'){for(j=0;j<this.data[i].length;++j){if(this.Get('chart.shadow')){RGraph.SetShadow(this,this.Get('chart.shadow.color'),this.Get('chart.shadow.offsetx'),this.Get('chart.shadow.offsety'),this.Get('chart.shadow.blur'));}
this.context.strokeStyle=this.Get('chart.strokestyle');this.context.fillStyle=this.Get('chart.colors')[j];if(this.Get('chart.colors.sequential')){this.context.fillStyle=this.Get('chart.colors')[colorIdx++];}
var width=((this.data[i][j]-this.Get('chart.xmin'))/(this.max-this.Get('chart.xmin')))*(this.canvas.width-this.gutterLeft-this.gutterRight);var individualBarHeight=((height-(2*vmargin))/this.data[i].length)-(2*this.Get('chart.vmargin.grouped'));var startX=this.gutterLeft;var startY=y+vmargin+(j*(individualBarHeight+this.Get('chart.vmargin.grouped')+this.Get('chart.vmargin.grouped')));if(this.Get('chart.yaxispos')=='center'){width/=2;startX+=halfwidth;}
if(width<0){startX+=width;width*=-1;}
this.context.strokeRect(startX,startY+this.Get('chart.vmargin.grouped'),width,individualBarHeight);this.context.fillRect(startX,startY+this.Get('chart.vmargin.grouped'),width,individualBarHeight);this.coords.push([startX,startY+this.Get('chart.vmargin.grouped'),width,individualBarHeight,this.context.fillStyle,this.data[i][j],true]);}}
this.context.closePath();}
this.context.fill();this.context.stroke();RGraph.NoShadow(this);this.RedrawBars();}
RGraph.HBar.prototype.RedrawBars=function()
{if(this.Get('chart.noredraw')){return;}
var coords=this.coords;var font=this.Get('chart.text.font');var size=this.Get('chart.text.size');var color=this.Get('chart.text.color');RGraph.NoShadow(this);this.context.strokeStyle=this.Get('chart.strokestyle');for(var i=0;i<coords.length;++i){if(this.Get('chart.shadow')){this.context.beginPath();this.context.strokeStyle=this.Get('chart.strokestyle');this.context.fillStyle=coords[i][4];this.context.lineWidth=1;this.context.strokeRect(coords[i][0],coords[i][1],coords[i][2],coords[i][3]);this.context.fillRect(coords[i][0],coords[i][1],coords[i][2],coords[i][3]);this.context.fill();this.context.stroke();}
if(this.Get('chart.labels.above')&&coords[i][6]){this.context.fillStyle=color;this.context.strokeStyle='black';RGraph.NoShadow(this);var border=(coords[i][0]+coords[i][2]+7+this.context.measureText(this.Get('chart.units.pre')+this.coords[i][5]+this.Get('chart.units.post')).width)>this.canvas.width?true:false;RGraph.Text(this.context,font,size,coords[i][0]+coords[i][2]+5,coords[i][1]+(coords[i][3]/2),RGraph.number_format(this,(this.coords[i][5]).toFixed(this.Get('chart.labels.above.decimals')),this.Get('chart.units.pre'),this.Get('chart.units.post')),'center','left');}}}
RGraph.HBar.prototype.getShape=RGraph.HBar.prototype.getBar=function(e)
{var canvas=this.canvas;var context=this.context;var mouseCoords=RGraph.getMouseXY(e);for(var i=0,len=this.coords.length;i<len;i++){var mouseX=mouseCoords[0];var mouseY=mouseCoords[1];var left=this.coords[i][0];var top=this.coords[i][1];var width=this.coords[i][2];var height=this.coords[i][3];var idx=i;if(mouseX>=left&&mouseX<=(left+width)&&mouseY>=top&&mouseY<=(top+height)){var tooltip=RGraph.parseTooltipText(this.Get('chart.tooltips'),i);return{0:this,'object':this,1:left,'x':left,2:top,'y':top,3:width,'width':width,4:height,'height':height,5:idx,'index':idx,'tooltip':tooltip};}}}
RGraph.HBar.prototype.getValue=function(arg)
{if(arg.length==2){var mouseX=arg[0];var mouseY=arg[1];}else{var mouseCoords=RGraph.getMouseXY(arg);var mouseX=mouseCoords[0];var mouseY=mouseCoords[1];}
if(mouseY<this.Get('chart.gutter.top')||mouseY>(this.canvas.height-this.Get('chart.gutter.bottom'))||mouseX<this.Get('chart.gutter.left')||mouseX>(this.canvas.width-this.Get('chart.gutter.right'))){return null;}
if(this.Get('chart.yaxispos')=='center'){var value=((mouseX-this.Get('chart.gutter.left'))/(this.graphwidth/2))*(this.max-this.Get('chart.xmin'));value=value-this.max
if(this.Get('chart.xmin')>0){value=((mouseX-this.Get('chart.gutter.left')-(this.graphwidth/2))/(this.graphwidth/2))*(this.max-this.Get('chart.xmin'));value+=this.Get('chart.xmin');if(mouseX<(this.gutterLeft+(this.graphwidth/2))){value-=(2*this.Get('chart.xmin'));}}}else{var value=((mouseX-this.Get('chart.gutter.left'))/this.graphwidth)*(this.max-this.Get('chart.xmin'));value+=this.Get('chart.xmin');}
return value;}
RGraph.HBar.prototype.Highlight=function(shape)
{RGraph.Highlight.Rect(this,shape);}
RGraph.HBar.prototype.getObjectByXY=function(e)
{var mouseXY=RGraph.getMouseXY(e);if(mouseXY[0]>this.Get('chart.gutter.left')&&mouseXY[0]<(this.canvas.width-this.Get('chart.gutter.right'))&&mouseXY[1]>this.Get('chart.gutter.top')&&mouseXY[1]<(this.canvas.height-this.Get('chart.gutter.bottom'))){return this;}}
RGraph.HBar.prototype.positionTooltip=function(obj,x,y,tooltip,idx)
{var coordX=obj.coords[tooltip.__index__][0];var coordY=obj.coords[tooltip.__index__][1];var coordW=obj.coords[tooltip.__index__][2];var coordH=obj.coords[tooltip.__index__][3];var canvasXY=RGraph.getCanvasXY(obj.canvas);var gutterLeft=obj.Get('chart.gutter.left');var gutterTop=obj.Get('chart.gutter.top');var width=tooltip.offsetWidth;var height=tooltip.offsetHeight;tooltip.style.left=0;tooltip.style.top=canvasXY[1]+coordY-height-7+(coordH/2)+'px';tooltip.style.overflow='';var img=new Image();img.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAFCAYAAACjKgd3AAAARUlEQVQYV2NkQAN79+797+RkhC4M5+/bd47B2dmZEVkBCgcmgcsgbAaA9GA1BCSBbhAuA/AagmwQPgMIGgIzCD0M0AMMAEFVIAa6UQgcAAAAAElFTkSuQmCC';img.style.position='absolute';img.id='__rgraph_tooltip_pointer__';img.style.top=(tooltip.offsetHeight-2)+'px';tooltip.appendChild(img);if((canvasXY[0]+coordX+(coordW/2)-(width/2))<10){tooltip.style.left=(canvasXY[0]+coordX-(width*0.1))+(coordW/2)+'px';img.style.left=((width*0.1)-8.5)+'px';}else if((canvasXY[0]+(coordW/2)+coordX+(width/2))>document.body.offsetWidth){tooltip.style.left=canvasXY[0]+coordX-(width*0.9)+(coordW/2)+'px';img.style.left=((width*0.9)-8.5)+'px';}else{tooltip.style.left=(canvasXY[0]+coordX+(coordW/2)-(width*0.5))+'px';img.style.left=((width*0.5)-8.5)+'px';}}